(function(){"use strict";var e={2194:function(e,t,i){var s=i(2893),n=i(5353),o=i(4521),a=i(3438),r=i(1673),l=i(8349),c=i(1447),d=(i(6060),i(6857)),u=i(9992),p=i(9125),h=function(){var e=this,t=e._self._c;return t("div",{staticClass:"stickyNav"},[t("div",{staticClass:"container"},[t("div",{staticClass:"stickyNav__nav"},[e.navItems.length>1?t("div",{staticClass:"stickyNav__links"},e._l(e.navItems,(function(i,s){return t("a",{key:i.fieldset,class:{"s--on":i.active},attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.scrollToFieldset(s)}}},[e._v(e._s(i.label))])})),0):e._e(),e._t("title")],2),t("div",{staticClass:"stickyNav__actions"},[e._t("actions")],2)])])},m=[],f=i(8221),v=i.n(f),b=i(8666),_={name:"A17StickyNav",props:{items:{type:Array,default:function(){return[]}}},data:function(){return{lastScrollPos:0,topOffset:70,ticking:!1,navItems:this.items,clickedFieldset:-1,fieldset:[]}},methods:{getFieldsetPosition:function(){const e=this;this.lastScrollPos=window.pageYOffset,this.navItems.forEach((function(t,i){const n=e.fieldset[i],o=n?n.getBoundingClientRect().top+e.lastScrollPos:0;s["default"].set(t,"position",o)}))},setActiveItems:function(){const e=this;let t=0;this.navItems.forEach((function(i,n){const o=i.position-e.topOffset<e.lastScrollPos;s["default"].set(i,"active",!1),o&&n>0&&(t=n)})),this.clickedFieldset>=0?s["default"].set(e.navItems[e.clickedFieldset],"active",!0):void 0!==e.navItems[t]&&s["default"].set(e.navItems[t],"active",!0)},refresh:function(){const e=this;e.clickedFieldset=-1,this.getFieldsetPosition(),this.setActiveItems(),e.ticking=!1},_resize:v()((function(){this.lastScrollPos=window.pageYOffset,this.refresh()}),200),_scroll:function(){const e=this;this.lastScrollPos=window.pageYOffset,e.ticking||window.requestAnimationFrame((function(){e.refresh(),e.ticking=!1})),e.ticking=!0},scrollToFieldset:function(e){const t=this,i=this.navItems[e].position-this.topOffset+1;this.dispose(),this.clickedFieldset=e,this.getFieldsetPosition(),this.setActiveItems(),(0,b.A)({offset:i,easing:"easeOut",onComplete:function(){t.init()}})},init:function(){window.addEventListener("scroll",this._scroll),window.addEventListener("resize",this._resize)},dispose:function(){window.removeEventListener("scroll",this._scroll),window.removeEventListener("resize",this._resize)}},mounted:function(){const e=this;this.navItems.forEach((function(t,i){const s=document.querySelector("#"+t.fieldset);s?e.fieldset.push(s):e.fieldset.push(null)})),this.refresh(),this.init()},beforeDestroy:function(){this.dispose()}},g=_,w=i(1656),k=(0,w.A)(g,h,m,!1,null,"c3e98050",null),y=k.exports,A=function(){var e=this,t=e._self._c;return t("div",{staticClass:"titleEditor",class:e.titleEditorClasses},[t("div",{staticClass:"titleEditor__preview"},[t("h2",{staticClass:"titleEditor__title",class:{"titleEditor__title-only":!e.permalink}},[e.editableTitle?t("a",{staticClass:"titleEditor__title-wrapper",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.$refs.editModal.open()}}},[e.thumbnail?t("a17-avatar",{attrs:{name:e.title,thumbnail:e.thumbnail}}):e._e(),t("span",{staticClass:"titleEditor__title"},[t("span",{staticClass:"f--underlined--o"},[e._v(e._s(e.title))]),e._v(" "),t("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"edit"}})])],1):t("span",{staticClass:"titleEditor__title-wrapper"},[e.thumbnail?t("a17-avatar",{attrs:{name:e.title,thumbnail:e.thumbnail}}):e._e(),t("span",{staticClass:"titleEditor__title"},[e._v(" "+e._s(e.customTitle?e.customTitle:e.title)+" ")])],1)]),!e.permalink&&!e.customPermalink||e.showModal?e._e():t("a",{staticClass:"titleEditor__permalink f--small",attrs:{href:e.fullUrl,target:"_blank"}},[t("span",{staticClass:"f--note f--external f--underlined--o"},[e._v(e._s(e._f("prettierUrl")(e.visibleUrl)))])]),e.showModal?t("span",{staticClass:"titleEditor__permalink f--small f--note f--external f--underlined--o"},[e._v(e._s(e._f("prettierUrl")(e.visibleUrl)))]):e._e(),t("a17-modal",{ref:"editModal",staticClass:"modal--form",attrs:{title:e.modalTitle,forceLock:e.disabled}},[t("a17-langmanager",{attrs:{"control-publication":e.controlLanguagesPublication}}),t("form",{ref:"modalForm",attrs:{action:"#"},on:{submit:function(t){return t.preventDefault(),e.update.apply(null,arguments)}}},[e._t("modal-form"),t("a17-modal-validation",{attrs:{mode:e.mode},on:{disable:e.lockModal}})],2)],1)],1),e._t("default")],2)},E=[],C=i(2952),S=i(1310),L=i(9598),P=i(7829),I=i(6262),x=i(6742),O={name:"A17TitleEditor",mixins:[P.A,I.A],components:{"a17-avatar":C.A,"a17-modal-validation":L.A,"a17-langmanager":S.A},props:{modalTitle:{type:String,default:function(){return this.$trans("modal.update.title")}},warningMessage:{type:String,default:"Missing title"},thumbnail:{type:String,default:""},showModal:{type:Boolean,default:!1},name:{default:"title"},editableTitle:{type:Boolean,default:!0},controlLanguagesPublication:{type:Boolean,default:!0},customTitle:{type:String,default:""},customPermalink:{type:String,default:""},localizedPermalinkbase:{type:String,default:""},localizedCustomPermalink:{type:String,default:""}},data:function(){return{disabled:!1}},mounted:function(){this.showModal&&this.$refs.editModal.open()},computed:{titleEditorClasses:function(){return{"titleEditor--error":this.error||this.title===this.warningMessage}},mode:function(){return this.showModal?"done":this.title.length>0?"update":"create"},fullUrl:function(){return this.customlink||this.baseUrl.replace("{language}",this.currentLocale.value).replace("{preview}/",this.published?"":"admin-preview/")+this.permalink},visibleUrl:function(){return this.customlink||this.baseUrl.replace("{language}",this.currentLocale.value).replace("{preview}/","")+this.permalink},title:function(){const e=this.fieldValueByName(this.name)?this.fieldValueByName(this.name):"",t="string"===typeof e?e:e[this.currentLocale.value];return t||this.warningMessage},customlink:function(){const e=this.localizedCustomPermalink.length>0?JSON.parse(this.localizedCustomPermalink):{};return Object.keys(e).length>0?e[this.currentLocale.value]:!!this.customPermalink&&this.customPermalink},permalink:function(){const e=this.localizedPermalinkbase.length>0?JSON.parse(this.localizedPermalinkbase):{};return Object.keys(e).length>0&&this.currentLocale.value in e?e[this.currentLocale.value].concat("/",this.fieldValueByName("slug")[this.currentLocale.value]):this.fieldValueByName("slug")[this.currentLocale.value]},...(0,n.aH)({baseUrl:e=>e.form.baseUrl,currentLocale:e=>e.language.active,languages:e=>e.language.all,fields:e=>e.form.fields,published:e=>e.publication.published}),...(0,n.L8)(["fieldValueByName"])},filters:x.A,methods:{update:function(){this.$refs.editModal.hide()},lockModal:function(e){this.disabled=e}}},T=O,D=(0,w.A)(T,A,E,!1,null,"0aa96d21",null),$=D.exports,B=i(3023),R=function(){var e=this,t=e._self._c;return t("div",{staticClass:"publisher__wrapper"},[e.withPublicationToggle?t("a17-switcher",{attrs:{title:e.$trans("publisher.switcher-title","Status"),name:"publish_state",textEnabled:e.textEnabled,textDisabled:e.textDisabled,"text-scheduled":e.textScheduled,"text-expired":e.textExpired}}):e._e(),e._t("default"),e.userInfo?t("a17-userinfo",{attrs:{userInfo:e.userInfo}}):e._e(),e.reviewProcess&&e.reviewProcess.length?t("a17-reviewaccordion",{attrs:{options:e.reviewProcess,name:"review_process",value:e.reviewProcessCompleteValues,open:e.openStates["A17Reviewaccordion"]},on:{open:e.openCloseAccordion}},[e._v(e._s(e.$trans("publisher.review-status")))]):e._e(),e.visibility&&e.visibilityOptions&&e.visibilityOptions.length?t("a17-radioaccordion",{attrs:{radios:e.visibilityOptions,name:"visibility",value:e.visibility,open:e.openStates["A17Radioaccordion"]},on:{open:e.openCloseAccordion,change:e.updateVisibility}},[e._v(e._s(e.$trans("publisher.visibility")))]):e._e(),e.languages&&e.showLanguages&&e.languages.length>1?t("a17-checkboxaccordion",{attrs:{options:e.languages,name:"active_languages",value:e.publishedLanguagesValues,open:e.openStates["A17Checkboxaccordion"]},on:{open:e.openCloseAccordion}},[e._v(e._s(e.$trans("publisher.languages")))]):e._e(),e.withPublicationTimeframe?t("a17-pubaccordion",{attrs:{"date-display-format":e.localizedDateDisplayFormat,"date-format":e.dateFormat,date_24h:e.date_24h,open:e.openStates["A17Pubaccordion"]},on:{open:e.openCloseAccordion}},[e._v(e._s(e.$trans("publisher.published-on")))]):e._e(),e.revisions.length?t("a17-revaccordion",{attrs:{open:e.openStates["A17Revisions"],revisions:e.revisions},on:{open:e.openCloseAccordion}},[e._v(e._s(e.$trans("publisher.revisions")))]):e._e(),e.parents.length?t("a17-parentaccordion",{attrs:{open:e.openStates["A17Parents"],parents:e.parents,value:e.parentId},on:{open:e.openCloseAccordion}},[e._v(e._s(e.$trans("publisher.parent-page")))]):e._e(),e.revisions.length?t("div",{staticClass:"publisher__item"},[t("a",{staticClass:"publisher__link",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.openPreview.apply(null,arguments)}}},[t("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"preview"}}),t("span",{staticClass:"f--link-underlined--o"},[e._v(e._s(e.$trans("publisher.preview")))])])]):e._e(),t("div",{staticClass:"publisher__item publisher__item--btns"},[t("a17-multibutton",{attrs:{options:e.submitOptions,type:"submit",message:e.submitDisableMessage},on:{"button-clicked":e.buttonClicked}})],1)],2)},N=[],M=function(){var e=this,t=e._self._c;return t("a17-accordion",{attrs:{open:e.open},on:{toggleVisibility:e.notifyOpen}},[t("span",{attrs:{slot:"accordion__title"},slot:"accordion__title"},[e._t("default")],2),t("div",{attrs:{slot:"accordion__value"},slot:"accordion__value"},[e._v(e._s(e.currentLabel))]),t("a17-checkboxgroup",{attrs:{name:e.name,options:e.options,selected:e.currentValue,min:1},on:{change:e.changeValue}})],1)},V=[],F=i(4160),U=function(){var e=this,t=e._self._c;return t("div",{staticClass:"accordion",class:e.visibilityClasses},[t("button",{staticClass:"accordion__trigger",attrs:{type:"button","aria-expanded":e.visible?"true":"false"},on:{click:e.onClickVisibility}},[e._t("accordion__title"),t("span",{staticClass:"accordion__value"},[e._t("accordion__value")],2),t("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"dropdown_module"}})],2),t("transition",{attrs:{css:!1,duration:275},on:{"before-enter":e.beforeEnter,"before-leave":e.beforeLeave,enter:e.enter,leave:e.leave}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"accordion__dropdown",attrs:{"aria-hidden":!e.visible}},[t("div",{staticClass:"accordion__list"},[e._t("default")],2)])])],1)},z=[],W={name:"A17Accordion",mixins:[F.A],watch:{open:function(){this.visible!==this.open&&(this.visible=this.open)}},methods:{getMaxHeight:function(){return Math.min(250,this.$el.querySelector(".accordion__list").clientHeight+1)},beforeEnter:function(e){e.style.maxHeight="0px"},enter:function(e,t){e.style.maxHeight=this.getMaxHeight()+"px"},beforeLeave:function(e,t){e.style.maxHeight=this.getMaxHeight()+"px"},leave:function(e,t){e.style.maxHeight="0px"}}},j=W,H=(0,w.A)(j,U,z,!1,null,"0dd10376",null),K=H.exports,q={name:"A17Checkboxaccordion",components:{"a17-accordion":K},mixins:[F.A],props:{value:{default:function(){return[]}},title:{type:String,default:""},name:{type:String,default:""},options:{default:function(){return[]}}},data:function(){return{currentValue:this.value}},watch:{value:function(e){this.currentValue=e}},computed:{currentLabel:function(){return this.currentValue.length+" "+this.$trans("publisher.languages-published")}},methods:{changeValue:function(e){this.currentValue=e,this.$store.commit(a.Np.PUBLISH_LANG,e)},notifyOpen:function(e){this.$emit("open",e,this.$options.name)}}},G=q,Y=(0,w.A)(G,M,V,!1,null,null,null),J=Y.exports,X=function(){var e=this,t=e._self._c;return t("div",{staticClass:"multibutton"},[t("a17-dropdown",{ref:"submitDown",attrs:{position:"bottom-right",width:"full",offset:0}},[e.isDisabled(e.options[0])?t("a17-button",{attrs:{type:"button",variant:"validate",disabled:!0}},[e._v(e._s(e.options[0].text))]):t("a17-button",{attrs:{type:e.type,name:e.options[0].name,variant:"validate"},on:{click:function(t){return e.buttonClicked(e.options[0].name)}}},[e._v(e._s(e.options[0].text))]),e.otherOptions.length?[e.hasValidOptions?t("button",{staticClass:"multibutton__trigger",attrs:{type:"button"},on:{click:function(t){return e.$refs.submitDown.toggle()}}},[t("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"dropdown_module"}})]):e._e(),t("div",{attrs:{slot:"dropdown__content"},slot:"dropdown__content"},[t("ul",e._l(e.otherOptions,(function(i){return t("li",{key:i.name},[e.isDisabled(i)?t("button",{attrs:{type:"button",disabled:""}},[e._v(e._s(i.text))]):t("button",{attrs:{type:e.type,name:i.name},on:{click:function(t){return e.buttonClicked(i.name)}}},[e._v(e._s(i.text))])])})),0)])]:e._e()],2)],1)},Z=[],Q={name:"A17Multibutton",props:{type:{default:"button"},message:{type:String,default:""},options:{default:function(){return[]}}},data:function(){return{}},computed:{otherOptions:function(){return this.options.length?this.options.slice(1):[]},hasValidOptions:function(){const e=this.options.filter((function(e){return!e.hasOwnProperty("disabled")||!1===e.disabled})),t=Boolean(e.length>0);return!t&&this.message&&this.$store.commit(a.yp.SET_NOTIF,{message:this.message,variant:"success"}),t}},methods:{isDisabled:function(e){return!!e.hasOwnProperty("disabled")&&!0===e.disabled},buttonClicked:function(e){this.$emit("button-clicked",e)}}},ee=Q,te=(0,w.A)(ee,X,Z,!1,null,"58557532",null),ie=te.exports,se=function(){var e=this,t=e._self._c;return t("a17-accordion",{attrs:{open:e.open},on:{toggleVisibility:e.notifyOpen}},[t("span",{attrs:{slot:"accordion__title"},slot:"accordion__title"},[e._t("default")],2),t("div",{attrs:{slot:"accordion__value"},domProps:{innerHTML:e._s(e.currentLabel)},slot:"accordion__value"}),t("div",{staticClass:"accordion__fields"},[t("a17-select",{attrs:{name:"parent_id",options:e.options,selected:e.currentValue,size:"small"},on:{change:e.updateSelected}})],1)])},ne=[];function oe(e,t){const i=[];function s(e){return Array(e+1).join(t)+" "}function n(e,t){e.forEach((function(e){const o={};if(o.value=e.id,e.edit&&(o.edit=e.edit),o.label=s(t)+e.name,i.push(o),e.children&&e.children.length){const i=t+1;n(e.children,i)}}))}return n(e,0),i}var ae={name:"A17Parents",components:{"a17-accordion":K},mixins:[F.A],props:{value:{default:0},parents:{default:function(){return[]}}},computed:{currentLabel:function(){const e=this.options.filter(this.isSameValue);return e.length?e[0].label:""},options:function(){const e=oe(this.parents,"&nbsp;&nbsp;&nbsp;"),t={value:0,label:"(No parent)"};return e.unshift(t),e},...(0,n.aH)({currentValue:e=>e.parents.active})},methods:{isSameValue:function(e){return e.value===this.currentValue},updateSelected:function(e){this.$store.commit(a.we.UPDATE_PARENT,e)},notifyOpen:function(e){this.$emit("open",e,this.$options.name)}}},re=ae,le=(0,w.A)(re,se,ne,!1,null,"606c5ad8",null),ce=le.exports,de=function(){var e=this,t=e._self._c;return t("a17-accordion",{attrs:{open:e.open},on:{toggleVisibility:e.notifyOpen}},[t("span",{attrs:{slot:"accordion__title"},slot:"accordion__title"},[e._t("default")],2),t("div",{attrs:{slot:"accordion__value"},slot:"accordion__value"},[e.startDate?[e._v(" "+e._s(e._f("formatDateWithFormat")(e.startDateForDisplay,e.localizedDateDisplayFormat))+" ")]:[e._v(" "+e._s(e.defaultStartDate)+" ")]],2),t("div",{staticClass:"accordion__fields"},[t("a17-datepicker",{attrs:{name:"publish_date","place-holder":e.$trans("publisher.start-date"),time_24hr:e.date_24h,altFormat:e.dateFormat,initialValue:e.startDate,maxDate:e.endDate,enableTime:!0,allowInput:!1,staticMode:!0,clear:!0},on:{open:e.openStartCalendar,close:e.closeCalendar,input:e.updateStartDate}}),t("a17-datepicker",{attrs:{name:"end_date","place-holder":e.$trans("publisher.end-date"),time_24hr:e.date_24h,altFormat:e.dateFormat,initialValue:e.endDate,minDate:e.startDate,enableTime:!0,allowInput:!1,staticMode:!0,clear:!0},on:{open:e.openEndCalendar,close:e.closeCalendar,input:e.updateEndDate}})],1)])},ue=[],pe=i(6221),he=i.n(pe),me=i(9495),fe={name:"A17Pubaccordion",components:{"a17-accordion":K},mixins:[F.A],props:{defaultStartDate:{type:String,default:function(){return this.$trans("publisher.immediate")}},defaultEndDate:{type:String,default:""},dateDisplayFormat:{type:String,default:null},dateFormat:{type:String,default:null},date_24h:{type:Boolean,default:(0,me.aK)()}},filters:x.A,computed:{...(0,n.aH)({startDate:e=>e.publication.startDate,endDate:e=>e.publication.endDate}),startDateForDisplay(){return he()(this.startDate+"Z").toISOString()},localizedDateDisplayFormat(){return this.dateDisplayFormat?this.dateDisplayFormat:"MMM, DD, YYYY, "+(0,me.x1)(this.date_24h)}},methods:{updateStartDate:function(e){this.$store.commit(a.N.UPDATE_PUBLISH_START_DATE,e)},updateEndDate:function(e){this.$store.commit(a.N.UPDATE_PUBLISH_END_DATE,e)},notifyOpen:function(e){this.$emit("open",e,this.$options.name)},openCalendar:function(){setTimeout((function(){const e=document.querySelectorAll(".accordion.s--open, .accordion.s--open .accordion__dropdown");e.forEach((function(e){e.style.overflow="visible"}))}),10)},openStartCalendar:function(){this.openCalendar()},openEndCalendar:function(){this.openCalendar()},closeCalendar:function(){const e=document.querySelectorAll(".accordion.s--open, .accordion.s--open .accordion__dropdown");e.forEach((function(e){e.style.overflow=""}))}}},ve=fe,be=(0,w.A)(ve,de,ue,!1,null,null,null),_e=be.exports,ge=function(){var e=this,t=e._self._c;return t("a17-accordion",{attrs:{open:e.open},on:{toggleVisibility:e.notifyOpen}},[t("span",{attrs:{slot:"accordion__title"},slot:"accordion__title"},[e._t("default")],2),t("div",{attrs:{slot:"accordion__value"},slot:"accordion__value"},[e._v(e._s(e.currentLabel))]),t("a17-radiogroup",{attrs:{name:e.name,radios:e.radios,initialValue:e.currentValue},on:{change:e.changeValue}})],1)},we=[],ke={name:"A17Radioaccordion",components:{"a17-accordion":K},mixins:[F.A],props:{value:{default:""},title:{default:""},name:{default:""},radios:{default:function(){return[]}}},data:function(){return{currentValue:this.value}},computed:{currentLabel:function(){const e=this.radios.filter(this.isSameValue);return e.length?e[0].label:""}},methods:{isSameValue:function(e){return e.value===this.currentValue},changeValue:function(e){this.currentValue=e,this.$emit("change",e)},notifyOpen:function(e){this.$emit("open",e,this.$options.name)}}},ye=ke,Ae=(0,w.A)(ye,ge,we,!1,null,null,null),Ee=Ae.exports,Ce=function(){var e=this,t=e._self._c;return t("a17-accordion",{attrs:{open:e.open},on:{toggleVisibility:e.notifyOpen}},[t("span",{attrs:{slot:"accordion__title"},slot:"accordion__title"},[e._t("default")],2),t("div",{attrs:{slot:"accordion__value"},slot:"accordion__value"},[e._v(e._s(e.currentLabel))]),t("a17-checkboxgroup",{attrs:{name:e.name,options:e.currentOptions,selected:e.currentValue},on:{change:e.changeValue}})],1)},Se=[],Le={name:"A17Reviewaccordion",components:{"a17-accordion":K},mixins:[F.A],props:{value:{default:function(){return[]}},title:{type:String,default:""},name:{type:String,default:""},options:{default:function(){return[]}}},data:function(){return{currentOptions:this.options,currentValue:this.value}},computed:{currentLabel:function(){let e="Pending approval";const t=this.currentValue[this.currentValue.length-1];return this.currentValue.length&&this.options.forEach((function(i){i.value===t&&(e=i.display)})),e}},methods:{changeValue:function(e){this.currentValue=e,this.$store.commit(a.N.UPDATE_REVIEW_PROCESS,e)},notifyOpen:function(e){this.$emit("open",e,this.$options.name)}}},Pe=Le,Ie=(0,w.A)(Pe,Ce,Se,!1,null,null,null),xe=Ie.exports,Oe=function(){var e=this,t=e._self._c;return t("a17-accordion",{attrs:{open:e.open},on:{toggleVisibility:e.notifyOpen}},[t("span",{attrs:{slot:"accordion__title"},slot:"accordion__title"},[e._t("default"),e._v(" "),t("span",{staticClass:"f--small f--note"},[e._v("("+e._s(e.revisions.length)+")")])],2),t("div",{attrs:{slot:"accordion__value"},slot:"accordion__value"},[e._v(e._s(e.$trans("publisher.last-edit"))+" "),t("timeago",{attrs:{"auto-update":1,datetime:new Date(e.revisions[0].datetime)}})],1),t("div",{staticClass:"revaccordion__scroller"},[t("ul",{staticClass:"revaccordion__list"},e._l(e.revisions,(function(i){return t("li",{key:i.id,staticClass:"revaccordion__item"},[t("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.openPreview(i.id)}}},[t("span",{staticClass:"revaccordion__author"},[e._v(e._s(i.author))]),t("span",{staticClass:"revaccordion__datetime"},[i.label?t("span",{staticClass:"tag"},[e._v(e._s(i.label))]):e._e(),e._v(" "+e._s(e._f("formatDate")(i.datetime))+" ")])])])})),0)])])},Te=[],De={name:"A17Revisions",components:{"a17-accordion":K},mixins:[F.A],props:{revisions:{default:function(){return[]}}},filters:x.A,methods:{notifyOpen:function(e){this.$emit("open",e,this.$options.name)},openPreview:function(e){this.$root.$refs.preview&&this.$root.$refs.preview.open(parseInt(e))}}},$e=De,Be=(0,w.A)($e,Oe,Te,!1,null,"5bbe0639",null),Re=Be.exports,Ne=function(){var e=this,t=e._self._c;return t("div",{staticClass:"switcher",class:e.switcherClasses},[t("h4",{staticClass:"switcher__title"},[e._v(e._s(e.title))]),t("label",{staticClass:"switcher__button",attrs:{for:e.name+"_live"}},[e.isChecked?t("span",{staticClass:"switcher__label"},[e._v(e._s(e.formatTextEnabled))]):e._e(),e.isChecked?e._e():t("span",{staticClass:"switcher__label"},[e._v(e._s(e.formatTextDisabled))]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.checkedValue,expression:"checkedValue"}],attrs:{type:"checkbox",disabled:e.disabled,name:e.name,id:e.name+"_live",value:"live"},domProps:{checked:Array.isArray(e.checkedValue)?e._i(e.checkedValue,"live")>-1:e.checkedValue},on:{change:function(t){var i=e.checkedValue,s=t.target,n=!!s.checked;if(Array.isArray(i)){var o="live",a=e._i(i,o);s.checked?a<0&&(e.checkedValue=i.concat([o])):a>-1&&(e.checkedValue=i.slice(0,a).concat(i.slice(a+1)))}else e.checkedValue=n}}}),t("span",{staticClass:"switcher__switcher"})])])},Me=[],Ve=i(7291),Fe=i.n(Ve),Ue={name:"A17Toggle",props:{name:{type:String,default:""},title:{default:"Status"},disabled:{type:Boolean,default:!1},textEnabled:{type:String,default:"Live"},textDisabled:{type:String,default:"Draft"},textExpired:{type:String,default:"Expired"},textScheduled:{type:String,default:"Scheduled"}},filters:x.A,computed:{switcherClasses:function(){return[this.isChecked?"switcher--active":"",this.formatTextEnabled?`switcher--${this.$options.filters.lowercase(this.formatTextEnabled)}`:""]},isChecked:function(){return this.published},formatTextEnabled:function(){const e=Fe()(this.startDate,new Date),t=Fe()(this.endDate,new Date);return this.endDate&&t<0?this.textExpired:this.startDate&&e>0?this.textScheduled:this.textEnabled},formatTextDisabled:function(){return this.textDisabled},checkedValue:{get:function(){return this.published},set:function(e){this.$store.commit(a.N.UPDATE_PUBLISH_STATE,e),this.$emit("change",e)}},...(0,n.aH)({startDate:e=>e.publication.startDate,endDate:e=>e.publication.endDate,published:e=>e.publication.published})}},ze=Ue,We=(0,w.A)(ze,Ne,Me,!1,null,"285ca0dd",null),je=We.exports,He=function(){var e=this,t=e._self._c;return t("div",{staticClass:"userInfo"},[t("div",{staticClass:"userInfo__content"},[e.userInfo.registered_at?t("div",{staticClass:"userInfo__item"},[t("div",{staticClass:"userInfo__row"},[t("span",{staticClass:"userInfo__row-cell"},[e._v("Registered at")]),t("span",{staticClass:"userInfo__row-cell userInfo__row-cell--value"},[e._v(e._s(e.userInfo.registered_at))])])]):e._e(),e.userInfo.last_login_at?t("div",{staticClass:"userInfo__item"},[t("div",{staticClass:"userInfo__row"},[t("span",{staticClass:"userInfo__row-cell"},[e._v("Last login at")]),t("span",{staticClass:"userInfo__row-cell userInfo__row-cell--value"},[e._v(e._s(e.userInfo.last_login_at))])])]):e._e(),e.userInfo.resend_registration_link?t("div",{staticClass:"userInfo__item"},[t("a",{staticClass:"userInfo__link",attrs:{href:e.userInfo.resend_registration_link,type:"submit"}},[t("span",{staticClass:"f--link-underlined--o"},[e._v("Resend registration email")])])]):e._e(),t("div",{staticClass:"userInfo__item"},[t("button",{staticClass:"userInfo__link",attrs:{type:"button"},on:{click:e.openPasswordModal}},[t("span",{staticClass:"f--link-underlined--o"},[e._v(e._s(e.userInfo.is_activated?"Reset password":"Register account now"))])])])]),t("a17-modal",{ref:"passwordModal",staticClass:"modal--form",attrs:{title:e.userInfo.is_activated?`Reset password for ${e.userInfo.user_name}`:`Register account for ${e.userInfo.user_name}`},on:{hide:e.hidePasswordModal}},[t("div",{staticClass:"userInfo__form-row"},[t("a17-textfield",{attrs:{name:"new_password",id:"new_password",fieldName:"new_password",inStore:"value",label:"New password",maxlength:50,note:"Must have at least 8 characters",required:"",type:"password"}})],1),e.userInfo.is_activated?t("div",{staticClass:"userInfo__form-row"},[t("a17-singlecheckbox",{attrs:{inStore:"value",name:"require_password_change",initialValue:!1,id:"require_password_change",fieldName:"require_password_change",label:"Require password change at next login"}})],1):e._e(),t("div",{staticClass:"userInfo__form-row"},[t("a17-modal-validation",{attrs:{mode:e.userInfo.is_activated?"Update":"Create"}})],1)])],1)},Ke=[],qe=i(6343),Ge={name:"A17UserInfo",components:{"a17-textfield":qe.A,"a17-modal-validation":L.A},props:{userInfo:{type:Object,default:null}},data(){return{isPasswordModalOpen:!1}},methods:{openPasswordModal(){this.isPasswordModalOpen=!0,this.$refs.passwordModal.open(),this.$store.commit(a.PI.UPDATE_FORM_FIELD,{name:"reset_password",value:!0})},hidePasswordModal(){this.$store.commit(a.PI.UPDATE_FORM_FIELD,{name:"reset_password",value:!1})}}},Ye=Ge,Je=(0,w.A)(Ye,He,Ke,!1,null,"37e685f4",null),Xe=Je.exports,Ze={name:"A17Publisher",components:{"a17-switcher":je,"a17-radioaccordion":Ee,"a17-checkboxaccordion":J,"a17-reviewaccordion":xe,"a17-revaccordion":Re,"a17-parentaccordion":ce,"a17-pubaccordion":_e,"a17-multibutton":ie,"a17-userinfo":Xe},props:{showLanguages:{type:Boolean,default:!0},dateFormat:{type:String,default:null},dateDisplayFormat:{type:String,default:null},date_24h:{type:Boolean,default:(0,me.aK)()}},data:function(){return{singleOpen:!0,openStates:{A17Reviewaccordion:!1,A17Radioaccordion:!1,A17Checkboxaccordion:!1,A17Revisions:!1,A17Pubaccordion:!1,A17Parents:!1}}},filters:x.A,computed:{localizedDateDisplayFormat(){return this.dateDisplayFormat?this.dateDisplayFormat:"MMM, DD, YYYY, "+(0,me.x1)(this.date_24h)},reviewProcessCompleteValues:function(){const e=[];return this.reviewProcessComplete.length&&this.reviewProcessComplete.forEach((function(t){e.push(t.value)})),e},submitOptions:function(){return this.$store.getters.getSubmitOptions},publishedLanguagesValues:function(){const e=[];return this.publishedLanguages.length&&this.publishedLanguages.forEach((function(t){e.push(t.value)})),e},...(0,n.aH)({languages:e=>e.language.all,revisions:e=>e.revision.all,parentId:e=>e.parents.active,parents:e=>e.parents.all,published:e=>e.publication.published,publishSubmit:e=>e.publication.publishSubmit,textEnabled:e=>e.publication.publishedLabel,textDisabled:e=>e.publication.draftLabel,textExpired:e=>e.publication.expiredLabel,textScheduled:e=>e.publication.scheduledLabel,withPublicationToggle:e=>e.publication.withPublicationToggle,withPublicationTimeframe:e=>e.publication.withPublicationTimeframe,visibility:e=>e.publication.visibility,visibilityOptions:e=>e.publication.visibilityOptions,reviewProcess:e=>e.publication.reviewProcess,hasUnsavedChanges:e=>e.publication.hasUnsavedChanges,submitDisableMessage:e=>e.publication.submitDisableMessage,userInfo:e=>e.publication.userInfo}),...(0,n.L8)(["publishedLanguages","reviewProcessComplete"])},methods:{buttonClicked:function(e){this.$store.commit(a.N.UPDATE_SAVE_TYPE,e)},openCloseAccordion:function(e,t){if(this.singleOpen)if(e)for(const i in this.openStates)this.openStates[i]=i===t;else this.openStates[t]=!1},openPreview:function(){this.$root.$refs.preview&&this.$root.$refs.preview.open(0)},updateVisibility:function(e){this.$store.commit(a.N.UPDATE_PUBLISH_VISIBILITY,e)},openMoveToTrashModal:function(){this.$parent.$refs.moveToTrashModal.open()}}},Qe=Ze,et=(0,w.A)(Qe,R,N,!1,null,"5b644dbd",null),tt=et.exports,it=function(){var e=this,t=e._self._c;return e.parents.length||e.hasUrl?t("div",{staticClass:"pagenav"},[e.parents.length?t("div",{staticClass:"pagenav__form"},[t("a17-vselect",{attrs:{name:"parents_sources",placeholder:e.placeholder,size:"large",searchable:!0,options:e.options},on:{change:e.gotoUrl}})],1):e._e(),e.hasUrl?t("nav",{staticClass:"pagenav__nav"},[e.previousUrl?t("a",{staticClass:"pagenav__btn",attrs:{href:e.previousUrl}},[e._v("← "+e._s(e.previousLabel))]):t("span",{staticClass:"pagenav__btn"},[e._v("← "+e._s(e.previousLabel))]),e.nextUrl?t("a",{staticClass:"pagenav__btn",attrs:{href:e.nextUrl}},[e._v(e._s(e.nextLabel)+" →")]):t("span",{staticClass:"pagenav__btn"},[e._v(e._s(e.nextLabel)+" →")])]):e._e()]):e._e()},st=[],nt={name:"A17PageNav",props:{previousLabel:{type:String,default:"Previous page"},nextLabel:{type:String,default:"Next page"},previousUrl:{type:String,default:""},nextUrl:{type:String,default:""},placeholder:{type:String,default:""}},data:function(){return{}},computed:{hasUrl:function(){return this.previousUrl||this.nextUrl},options:function(){return oe(this.parents,"–")},...(0,n.aH)({parents:e=>e.parents.all})},methods:{gotoUrl:function(e){e.edit&&(window.location.href=e.edit)}},beforeMount:function(){}},ot=nt,at=(0,w.A)(ot,it,st,!1,null,"578ca18c",null),rt=at.exports,lt=i(1498),ct=function(){var e=this,t=e._self._c;return t("div",{staticClass:"content"},[t("draggable",e._b({staticClass:"content__content",model:{value:e.blocks,callback:function(t){e.blocks=t},expression:"blocks"}},"draggable",e.dragOptions,!1),[t("transition-group",{attrs:{name:"draggable_list",tag:"div"}},e._l(e.blocks,(function(i,s){return t("div",{key:i.id,staticClass:"content__item"},[t("a17-blockeditor-item",{ref:"blockList",refInFor:!0,attrs:{block:i,index:s,withHandle:e.draggable,size:e.blockSize,opened:e.opened}},[e.hasRemainingBlocks?t("a17-button",{attrs:{slot:"block-actions",variant:"icon","data-action":""},on:{click:function(t){return e.duplicateBlock(s)}},slot:"block-actions"},[t("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"add"}})]):e._e(),t("div",{attrs:{slot:"dropdown-action"},slot:"dropdown-action"},[e.opened?t("button",{attrs:{type:"button"},on:{click:function(t){return e.collapseAllBlocks()}}},[e._v(" "+e._s(e.$trans("fields.block-editor.collapse-all","Collapse all"))+" ")]):t("button",{attrs:{type:"button"},on:{click:function(t){return e.expandAllBlocks()}}},[e._v(" "+e._s(e.$trans("fields.block-editor.expand-all","Expand all"))+" ")]),e.hasRemainingBlocks?t("button",{attrs:{type:"button"},on:{click:function(t){return e.duplicateBlock(s)}}},[e._v(" "+e._s(e.$trans("fields.block-editor.clone-block","Clone block"))+" ")]):e._e(),t("button",{attrs:{type:"button"},on:{click:function(t){return e.deleteBlock(s)}}},[e._v(" "+e._s(e.$trans("fields.block-editor.delete","Delete"))+" ")])])],1)],1)})),0)],1),t("div",{staticClass:"content__trigger"},[e.hasRemainingBlocks&&e.blockType.trigger&&e.allowCreate?t("a17-button",{class:e.triggerClass,attrs:{variant:e.triggerVariant},on:{click:function(t){return e.addBlock()}}},[e._v(" "+e._s(e.blockType.trigger)+" ")]):e._e(),e.hasRemainingBlocks&&e.browser?t("a17-button",{class:e.triggerClass,attrs:{variant:e.triggerVariant},on:{click:function(t){return e.openBrowser()}}},[e._v(" "+e._s(e.blockType.selectTrigger)+" ")]):e._e(),t("div",{staticClass:"content__note f--note f--small"},[e._t("default")],2)],1),e.browserIsOpen?t("a17-standalone-browser",{ref:"localbrowser",attrs:{endpoint:e.browser,"for-repeater":!0,max:e.max},on:{selected:e.addRepeatersFromSelection,close:function(t){e.browserIsOpen=!1}}}):e._e()],1)},dt=[],ut=i(432),pt=i.n(ut),ht=i(1680),mt=i(8108),ft=i(1473),vt={name:"A17Repeater",components:{A17StandaloneBrowser:mt.A,"a17-blockeditor-item":ht["default"],draggable:pt()},mixins:[ft.A],props:{type:{type:String,required:!0},name:{type:String,required:!0},buttonAsLink:{type:Boolean,default:!1},browser:{type:Object,required:!1,default:null},relation:{type:String,required:!1},allowCreate:{type:Boolean,default:!0},max:{type:[Number,null],required:!1,default:null}},data:function(){return{opened:!0,browserIsOpen:!1,handle:".block__handle"}},computed:{triggerVariant:function(){return this.buttonAsLink?"aslink":this.inContentEditor?"outline":"action"},triggerClass:function(){return this.inContentEditor?"content__button":""},blockSize:function(){return this.inContentEditor?"small":""},inContentEditor:function(){return"undefined"!==typeof this.$parent.repeaterName},hasRemainingBlocks:function(){let e=null;return this.max&&this.max>0?e=this.max:this.blockType.hasOwnProperty("max")&&(e=this.blockType.max),!e||e>this.blocks.length},blockType:function(){return this.availableBlocks[this.type]?this.availableBlocks[this.type]:{}},blocks:{get(){return this.savedBlocks.hasOwnProperty(this.name)&&this.savedBlocks[this.name]||[]},set(e){this.$store.commit(a.PI.REORDER_FORM_BLOCKS,{type:this.type,name:this.name,blocks:e})}},...(0,n.aH)({savedBlocks:e=>e.repeaters.repeaters,availableBlocks:e=>e.repeaters.availableRepeaters})},methods:{setOpened:function(){const e=this.$refs.blockList&&this.$refs.blockList.every((e=>!e.visible));e&&(this.opened=!1)},addBlock:function(){this.$store.commit(a.PI.ADD_FORM_BLOCK,{type:this.type,name:this.name}),this.$nextTick((()=>{this.checkExpandBlocks()}))},addRepeatersFromSelection(e){this.$store.commit(a.PI.ADD_REPEATER_FROM_SELECTION,{type:this.type,name:this.name,selection:e,relation:this.relation})},duplicateBlock:function(e){this.$store.dispatch(r.Ay.DUPLICATE_REPEATER,{editorName:this.name,index:e,futureIndex:e+1,block:this.blocks[e],id:Date.now()+Math.floor(1e3*Math.random())}),this.$nextTick((()=>{this.checkExpandBlocks()}))},deleteBlock:function(e){this.$store.commit(a.PI.DELETE_FORM_BLOCK,{type:this.type,name:this.name,index:e})},collapseAllBlocks:function(){this.opened=!1},expandAllBlocks:function(){this.opened=!0},checkExpandBlocks(){void 0!==this.$refs.blockList[this.$refs.blockList.length-1]&&this.$refs.blockList[this.$refs.blockList.length-1].toggleExpand()},openBrowser:function(){this.browserIsOpen=!0}},mounted:function(){this.$nextTick((function(){this.$refs.blockList&&this.blocks&&this.blocks.length<4&&this.$refs.blockList.forEach((e=>e.toggleExpand())),this.setOpened()}))}},bt=vt,_t=(0,w.A)(bt,ct,dt,!1,null,"2b3828d6",null),gt=_t.exports,wt=function(){var e=this,t=e._self._c;return t("a17-inputframe",{attrs:{error:e.error,note:e.note,locale:e.locale,label:e.label,name:e.name,required:e.required},on:{localize:e.updateLocale}},[t("div",{staticClass:"form__field",class:e.textfieldClasses},[t("input",{attrs:{type:"search",placeholder:e.placeholder,name:e.name,id:e.name,disabled:e.disabled,required:e.required,readonly:e.readonly,autofocus:e.autofocus,autocomplete:e.autocomplete},domProps:{value:e.address},on:{focus:e.onFocus,blur:e.onBlur,input:e.onInput}}),e.showMap?t("div",{staticClass:"form__field--showMap"},[t("a",{attrs:{href:"#",type:"button"},on:{click:function(t){return t.preventDefault(),e.toggleMap.apply(null,arguments)}}},[t("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"location"}}),t("span",{domProps:{innerHTML:e._s(e.mapMessage)}})])]):e._e(),t("input",{attrs:{type:"hidden",name:`${e.name}__lat`},domProps:{value:e.lat}}),t("input",{attrs:{type:"hidden",name:`${e.name}__lng`},domProps:{value:e.lng}})]),e.showMap?t("div",{directives:[{name:"show",rawName:"v-show",value:e.isMapOpen,expression:"isMapOpen"}],staticClass:"form__mapContainer"}):e._e()])},kt=[],yt=i(2404),At=i.n(yt),Et=i(8197),Ct=i(9354),St=i(6410);const Lt={show:window.$trans("fields.map.show"),hide:window.$trans("fields.map.hide")},Pt="https://maps.googleapis.com/maps/api/js?libraries=places&key=",It=window["TWILL"].hasOwnProperty("APIKEYS")&&window["TWILL"].APIKEYS.hasOwnProperty("googleMapApi")?window["TWILL"].APIKEYS.googleMapApi:null;var xt={name:"A17Locationfield",mixins:[Ct.A,P.A,I.A,Et.A],props:{type:{type:String,default:"text"},zoom:{type:Number,default:15},showMap:{type:Boolean,default:!0},openMap:{type:Boolean,default:!1},saveExtendedData:{type:Boolean,default:!1},autoDetectLatLngValue:{type:Boolean,default:!1},initialLat:{type:Number,default:null},initialLng:{type:Number,default:null}},data:function(){return{map:null,autocompletePlace:null,markers:[],address:"",boundingBox:[],types:[],beforeFocusAddress:"",lat:this.initialLat,lng:this.initialLng,focused:!1,isMapOpen:this.openMap,mapMessage:this.openMap?Lt.hide:Lt.show}},computed:{value:{get(){const e={latlng:this.lat+"|"+this.lng,address:this.address};return this.saveExtendedData&&(e.boundingBox=this.boundingBox,e.types=this.types),e},set(e){const t=e.latlng.split("|");this.lat=parseFloat(t[0]),this.lng=parseFloat(t[t.length-1]),this.address=e.address,this.saveExtendedData&&(this.boundingBox=e.boundingBox,this.types=e.types)}},textfieldClasses:function(){return{"s--focus":this.focused,"s--disabled":this.disabled}}},methods:{updateFromStore:function(e){if(!At()(e,this.value)&&(this.value=e,this.clearMarkers(),""===this.address&&(this.lat=this.initialLat,this.lng=this.initialLng),this.lat&&this.lng&&this.map)){const e={lat:this.lat,lng:this.lng};this.addMarker(e),this.map.panTo(e)}},onFocus:function(e){this.focused=!0,this.beforeFocusAddress=this.address,this.$emit("focus")},onBlur:function(e){this.focused=!1,""===this.address&&(this.clearMarkers(),this.lat=this.initialLat,this.lng=this.initialLng),this.beforeFocusAddress!==this.address&&this.saveIntoStore(),this.$emit("blur")},onInput:function(e){const t=e.target.value;if(this.address=t,this.$emit("change",t),this.autoDetectLatLngValue){const e=t.match(/^(-?\d+(?:\.\d+)?),+ *(-?\d+(?:\.\d+)?)$/);e&&this.onLatLngEntered(e[1],e[2])}},onPlaceChanged:function(){const e=this.autocompletePlace.getPlace();if(this.clearMarkers(),this.clearLatLng(),e.geometry){const t=e.geometry.location;this.address=e.formatted_address,this.setLatLng(t),this.saveExtendedData&&(this.boundingBox=e.geometry.viewport,this.types=e.types),this.map&&(this.addMarker(t),this.map.panTo(t),this.map.setZoom(this.zoom))}this.beforeFocusAddress=this.address,this.saveIntoStore()},onClick:function(e){const t=e.latLng;this.clearMarkers(),this.clearLatLng(),this.address=[t.lat(),t.lng()].join(","),this.setLatLng(t),this.map&&this.addMarker(t),this.saveIntoStore()},onLatLngEntered:v()((function(e,t){const i=new google.maps.LatLng(e,t);this.clearMarkers(),this.clearLatLng(),this.address=[i.lat(),i.lng()].join(","),this.setLatLng(i),this.map&&(this.addMarker(i),this.map.setCenter(i)),this.saveIntoStore()}),600),clearMarkers:function(){for(let e=0;e<this.markers.length;e++)this.markers[e]&&this.markers[e].setMap(null);this.markers=[]},clearLatLng:function(){this.lat=0,this.lng=0},addMarker:function(e){const t=new google.maps.Marker({position:e,map:this.map});this.markers.push(t)},setLatLng:function(e){this.lat=e.lat(),this.lng=e.lng()},toggleMap:function(){this.isMapOpen=!this.isMapOpen,this.mapMessage=this.isMapOpen?Lt.hide:Lt.show,this.map||"undefined"===typeof google||this.$nextTick((function(){this.initMap()}))},initMap:function(){const e=this.lat+this.lng,t={zoom:e?this.zoom:1,center:new google.maps.LatLng(this.lat,this.lng),mapTypeControl:!1,panControl:!1,zoomControl:!1,streetViewControl:!1},i=document.createElement("div");i.className="form__map",this.$el.querySelector(".form__mapContainer").appendChild(i),this.map=new google.maps.Map(i,t),e&&this.addMarker(new google.maps.LatLng(this.lat,this.lng)),this.map.addListener("click",this.onClick)},initGeocoder:function(){const e=this;if(this.autocompletePlace=new google.maps.places.Autocomplete(this.$el.querySelector('input[type="search"]')),google.maps.event.addListener(this.autocompletePlace,"place_changed",this.onPlaceChanged),""===this.address&&this.lat&&this.lng){const t=new google.maps.Geocoder,i={lat:this.lat,lng:this.lng};t.geocode({location:i},(function(t,i){"OK"===i?t[1]?e.address=t[1].formatted_address:console.error("Geocoding - No results found"):console.error("Geocoding - Geocoder failed due to: "+i)}))}},initGoogleApi:function(){this.initGeocoder(),this.showMap&&this.isMapOpen&&this.initMap()}},mounted:function(){if("undefined"!==typeof google)this.initGoogleApi();else{const e="google-map-api-script",t=Pt+It;(0,St.k0)(e,t,"text/javascript").then((()=>{this.initGoogleApi()}))}},beforeDestroy:function(){"undefined"!==typeof google&&google.maps.event.clearListeners(this.autocompletePlace,"place_changed",this.onPlaceChanged)}},Ot=xt,Tt=(0,w.A)(Ot,wt,kt,!1,null,"c676a44e",null),Dt=Tt.exports,$t=function(){var e=this,t=e._self._c;return t("div",[e.keepAlive?[t("div",{directives:[{name:"show",rawName:"v-show",value:e.open,expression:"open"}]},[e._t("default")],2)]:[e.open?t("div",{ref:"fieldContainer"},[e._t("default")],2):e._e()]],2)},Bt=[],Rt=i(2629),Nt=i.n(Rt),Mt={name:"A17ConnectorField",props:{fieldName:{type:String,required:!0},requiredFieldValues:{default:""},inModal:{type:Boolean,default:!1},keepAlive:{type:Boolean,default:!1},arrayContains:{type:Boolean,default:!0},isValueEqual:{type:Boolean,default:!0},isBrowser:{type:Boolean,default:!1},matchEmptyBrowser:{type:Boolean,default:!1}},computed:{storedValue:function(){return this.inModal?this.modalFieldValueByName(this.fieldName):this.isBrowser?this.selectedBrowser[this.fieldName]:this.fieldValueByName(this.fieldName)},...(0,n.L8)(["fieldValueByName","modalFieldValueByName"]),...(0,n.aH)({fields:e=>e.form.fields,modalFields:e=>e.form.modalFields,selectedBrowser:e=>e.browser.selected})},data:function(){return{open:!1}},watch:{storedValue:function(e){this.toggleVisibility(e)}},methods:{toggleVisibility:function(e){if(this.$refs.fieldContainer&&this.$slots.default.forEach((e=>{void 0!==e.componentInstance&&e.componentInstance.$refs&&e.componentInstance.$refs.field?e.componentInstance.$refs.field[0]&&e.componentInstance.$refs.field[0].destroyValue():void 0!==e.componentInstance&&void 0!==e.componentInstance.$slots&&void 0!==e.componentInstance.$slots.default?e.componentInstance.$slots.default.forEach((e=>{e.componentInstance&&e.componentInstance.destroyValue&&e.componentInstance.destroyValue()})):e.componentInstance.destroyValue&&e.componentInstance.destroyValue()})),this.isBrowser){const t=(e&&e.length)??0;return this.matchEmptyBrowser&&0===t?void(this.open=!0):void(this.open=!this.matchEmptyBrowser&&t>0)}const t=Nt()(e),i=Nt()(this.requiredFieldValues),s=Array.isArray(i)?i:[i];Array.isArray(i)&&i.sort(),Array.isArray(t)&&t.sort(),this.isValueEqual?Array.isArray(t)?this.open=this.arrayContains?s.some((e=>t.includes(e))):this.open=JSON.stringify(s)===JSON.stringify(t):this.open=Array.isArray(i)?-1!==i.indexOf(t):At()(t,i):Array.isArray(t)?this.open=this.arrayContains?s.every((e=>!t.includes(e))):this.open=JSON.stringify(s)!==JSON.stringify(t):this.open=Array.isArray(i)?-1===i.indexOf(t):!At()(t,i)}},mounted:function(){const e=this;this.$nextTick((function(){e.toggleVisibility(this.storedValue)}))}},Vt=Mt,Ft=(0,w.A)(Vt,$t,Bt,!1,null,null,null),Ut=Ft.exports,zt=i(7965),Wt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"overlay",class:e.overlayClasses},[t("div",{staticClass:"overlay__window"},[t("header",{staticClass:"overlay__header"},[e.overlayTitle?t("span",[e._v(e._s(e.overlayTitle))]):e._e(),e.$slots["overlay__header"]?t("span",{staticClass:"overlay__header-slot"},[e._t("overlay__header")],2):e._e(),t("button",{staticClass:"overlay__close",attrs:{type:"button"},on:{click:e.hide}},[t("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"close_modal"}}),t("span",{staticClass:"overlay__closeLabel"},[e._v(e._s(e.$trans("overlay.close")))])])]),e.active?t("div",{directives:[{name:"show",rawName:"v-show",value:!e.hidden,expression:"!hidden"}],staticClass:"overlay__content"},[e._t("default")],2):e._e()])])},jt=[],Ht=i(6650);const Kt=document.documentElement,qt=Ht.A.overlay,Gt=Ht.A.modal;var Yt={name:"A17Overlay",props:{title:{type:String,default:""},revisionTitle:{type:String,default:function(){return this.$trans("previewer.revision-history")}},forceClose:{type:Boolean,default:!1},forceLock:{type:Boolean,default:!1},mode:{type:String,default:""},customClasses:{type:[String,Array],default:()=>[]}},data:function(){return{active:!1,hidden:!0,locked:!1}},computed:{toggleClasses(){const e="string"===typeof this.customClasses?[this.customClasses]:this.customClasses;return[qt].concat(e)},activeRevision:function(){return Object.keys(this.currentRevision).length},overlayTitle:function(){return this.activeRevision?this.revisionTitle:this.title},overlayClasses:function(){return{"overlay--active":this.active,"overlay--hidden":this.hidden}},...(0,n.aH)({currentRevision:e=>e.revision.active})},methods:{open:function(){this.active&&!this.hidden||(this.active=!0,this.hidden=!1,this.toggleClasses.forEach((e=>Kt.classList.add(e))),window.addEventListener("keyup",this.keyPressed),this.$emit("open"))},mask:function(){this.toggleClasses.forEach((e=>Kt.classList.remove(e))),window.removeEventListener("keyup",this.keyPressed),this.$emit("close")},hide:function(){this.active&&(this.locked||(this.forceClose?this.close():(this.hidden=!0,this.mask())))},close:function(e){this.active&&(this.locked||(this.active=!1,this.mask()))},keyPressed:function(e){if(27===e.which||27===e.keyCode){if(Kt.classList.contains(Gt))return;this.hide(),this.$emit("esc-key")}}},beforeDestroy:function(){this.$el.parentNode&&(this.active&&window.removeEventListener("keyup",this.keyPressed),this.$el.parentNode.removeChild(this.$el))}},Jt=Yt,Xt=(0,w.A)(Jt,Wt,jt,!1,null,"6227219a",null),Zt=Xt.exports,Qt=function(){var e=this,t=e._self._c;return t("a17-overlay",{ref:"overlay",attrs:{title:e.$trans("previewer.title")}},[e.revisions.length?t("div",{staticClass:"previewer",class:{"previewer--loading":e.loading}},[e.activeRevision?t("a17-button",{staticClass:"previewer__restore",attrs:{variant:"warning",size:"small"},on:{click:e.restoreRevision}},[e._v(e._s(e.$trans("previewer.restore")))]):e._e(),!e.activeRevision&&e.editor?t("a17-button",{staticClass:"previewer__restore",attrs:{variant:"editor",size:"small"},on:{click:e.openEditor}},[t("span",{directives:[{name:"svg",rawName:"v-svg"}],staticClass:"hide--xsmall",attrs:{symbol:"editor"}}),e._v(e._s(e.$trans("previewer.editor")))]):e._e(),t("div",{staticClass:"previewer__frame"},[t("div",{staticClass:"previewer__inner"},[t("div",{staticClass:"previewer__nav"},[t("div",{staticClass:"previewer__revisions"},[e.slipScreen?t("span",{staticClass:"tag tag--revision"},[e._v(e._s(e.$trans("previewer.past-revision")))]):e._e(),t("a17-dropdown",{ref:"previewRevisionsDropdown",attrs:{position:"bottom-left",maxWidth:400,maxHeight:300}},[t("a17-button",{staticClass:"previewer__trigger",on:{click:function(t){return e.$refs.previewRevisionsDropdown.toggle()}}},[e.activeRevision?[e._v(" "+e._s(e._f("formatDate")(e.currentRevision.datetime))+" ("+e._s(e.currentRevision.author)+") "),t("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"dropdown_module"}})]:[e._v(" "+e._s(e.$trans("previewer.last-edit"))+" "),t("timeago",{attrs:{"auto-update":1,datetime:new Date(e.revisions[0].datetime)}}),e._v(" "),t("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"dropdown_module"}})]],2),t("div",{attrs:{slot:"dropdown__content"},slot:"dropdown__content"},e._l(e.revisions,(function(i){return t("button",{key:i.id,staticClass:"previewerRevision",class:{"previewerRevision--active":e.currentRevision.id===i.id},attrs:{type:"button"},on:{click:function(t){return e.toggleRevision(i.id)}}},[t("span",{staticClass:"previewerRevision__author"},[e._v(e._s(i.author))]),t("span",{staticClass:"previewerRevision__datetime"},[i.label?t("span",{staticClass:"tag"},[e._v(e._s(i.label))]):e._e(),e._v(" "+e._s(e._f("formatDate")(i.datetime)))])])})),0)],1)],1),e.slipScreen?e._e():t("ul",{staticClass:"previewer__breakpoints"},e._l(e.breakpoints,(function(i){return t("li",{key:i.size,staticClass:"previewer__breakpoint",class:{"s--active":e.activeBreakpoint===i.size}},[t("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.resizePreview(i.size)}}},[t("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:i.name}})])])})),0),e.activeRevision?t("div",{staticClass:"previewer__compare"},[e.slipScreen?t("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.singleView.apply(null,arguments)}}},[t("span",{staticClass:"previewer__compareLabel"},[e._v(e._s(e.$trans("previewer.single-view")))]),e._v(" "),t("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"revision-single"}})]):t("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.compareView.apply(null,arguments)}}},[t("span",{staticClass:"previewer__compareLabel"},[e._v(e._s(e.$trans("previewer.compare-view")))]),e._v(" "),t("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"revision-compare"}})])]):e._e()]),t("div",{staticClass:"previewer__content"},[t("div",{staticClass:"previewer__iframe"},[t("a17-iframe",{attrs:{content:e.activeRevision?e.activeContent:e.currentContent,size:e.activeBreakpoint,scrollPosition:e.scrollPosition},on:{scrollDoc:e.setIframeScroll}})],1),e.slipScreen?t("div",{staticClass:"previewer__iframe"},[t("div",{staticClass:"previewer__iframeInfos"},[t("span",{staticClass:"tag tag--revision"},[e._v(e._s(e.$trans("previewer.current-revision")))]),e._v(e._s(e.$trans("previewer.unsaved")))]),t("a17-iframe",{attrs:{content:e.currentContent,scrollPosition:e.scrollPosition},on:{scrollDoc:e.setIframeScroll}})],1):e._e()])])])],1):e._e()])},ei=[],ti=function(){var e=this,t=e._self._c;return t("iframe",{staticClass:"previewerframe",style:{width:e.size>0?e.size+"px":""},attrs:{srcdoc:e.content,frameborder:"0"},on:{load:e.loadPreview}})},ii=[],si={name:"A17previewerFrame",props:{size:{type:Number,default:0},content:{type:String,default:""},scrollPosition:{type:Number,default:0}},data:function(){return{currentScroll:this.scrollPosition}},watch:{scrollPosition:function(e){this.$el.contentWindow.scrollTo(0,e)}},methods:{loadPreview:function(e){const t=this,i=e.target,s=Array.from(i.contentDocument.querySelectorAll("a:not(.sf-dump-toggle)")||[]);s.forEach((e=>{e.getAttribute("href").startsWith("#")&&"#"!==e.getAttribute("href")||(e.setAttribute("disabled","disabled"),e.style.pointerEvents="none"),e.onclick=function(e){if(!e.defaultPrevented)return!1}}));const n=Array.from(i.contentDocument.querySelectorAll("form")||[]);n.forEach((e=>{e.addEventListener("submit",(e=>{e.preventDefault()}),!0)})),i.contentDocument.addEventListener("scroll",(function(e){const s=i.contentWindow.pageYOffset;s!==t.currentScroll&&(t.$emit("scrollDoc",s),t.currentScroll=s)})),this.$el.contentWindow.scrollTo(0,this.currentScroll)}}},ni=si,oi=(0,w.A)(ni,ti,ii,!1,null,"0559a056",null),ai=oi.exports,ri={name:"A17Previewer",components:{"a17-iframe":ai},props:["breakpointsConfig"],data:function(){return{loadedCurrent:!1,slipScreen:!1,activeBreakpoint:1280,lastActiveBreakpoint:1280,scrollPosition:0,breakpoints:this.breakpointsConfig||[{size:1280,name:"preview-desktop"},{size:1024,name:"preview-tablet-h"},{size:768,name:"preview-tablet-v"},{size:390,name:"preview-mobile"}]}},filters:x.A,computed:{activeRevision:function(){return Object.keys(this.currentRevision).length},...(0,n.aH)({editor:e=>e.blocks.editor,loading:e=>e.revision.loading,currentRevision:e=>e.revision.active,activeContent:e=>e.revision.activeContent,currentContent:e=>e.revision.currentContent,revisions:e=>e.revision.all,restoreRevisionUrl:e=>e.form.restoreUrl})},methods:{open:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const t=this,i=this.breakpoints.find((e=>"preview-desktop"===e.name)).size;function s(){t.$refs.overlay&&t.$refs.overlay.open(),t.singleView()}this.loadedCurrent=!1,this.activeBreakpoint=i||1280,this.lastActiveBreakpoint=i||1280,e?this.previewRevision(e,(function(){s()})):this.previewCurrent((function(){s()}))},close:function(){this.$refs.overlay.close()},openEditor:function(){const e=this.$root.$refs;e.preview&&e.preview.close(),e.editor&&e.editor.open()},restoreRevision:function(){const e=new URL(this.restoreRevisionUrl);e.searchParams.append("revisionId",this.currentRevision.id),window.location.href=e.toString()},resizePreview:function(e){this.activeBreakpoint=parseInt(e),this.lastActiveBreakpoint=parseInt(e)},previewCurrent:function(e){this.$store.commit(a.sP.UPDATE_REV,0),this.loadCurrent(e)},loadCurrent:function(e){this.loadedCurrent?e&&"function"===typeof e&&e():(this.loadedCurrent=!0,this.$store.dispatch(r.Ay.GET_CURRENT).then((()=>{e&&"function"===typeof e&&e()}),(e=>{this.$store.commit(a.PI.SET_FORM_ERRORS,e.response.data),this.$store.commit(a.yp.SET_NOTIF,{message:"Your submission could not be validated, please fix and retry",variant:"error"})})))},toggleRevision:function(e){if(this.activeRevision&&this.currentRevision.id===e)return this.singleView(),void this.previewCurrent();this.previewRevision(e)},previewRevision:function(e,t){this.$store.commit(a.sP.UPDATE_REV,e),this.$store.dispatch(r.Ay.GET_REVISION).then((()=>{t&&"function"===typeof t&&t()}),(e=>{this.$store.commit(a.yp.SET_NOTIF,{message:"Invalid revision.",variant:"error"})}))},compareView:function(){this.activeBreakpoint=0,this.slipScreen=!0,this.activeRevision&&this.loadCurrent()},singleView:function(){this.activeBreakpoint=this.lastActiveBreakpoint,this.slipScreen=!1},setIframeScroll:function(e){this.scrollPosition=e}}},li=ri,ci=(0,w.A)(li,Qt,ei,!1,null,"86c441e0",null),di=ci.exports,ui=function(){var e=this,t=e._self._c;return t("a17-overlay",{ref:"overlay",attrs:{title:e.$trans("editor.title"),customClasses:e.htmlEditorClass},on:{close:e.close},scopedSlots:e._u([e.editorNames.length>1?{key:"overlay__header",fn:function(){return[t("a17-dropdown",{ref:"editorDropdown",attrs:{position:"bottom-left",maxWidth:400,maxHeight:300}},[t("a17-button",{staticClass:"editorDropdown__trigger",on:{click:function(t){return e.$refs.editorDropdown.toggle()}}},[e._v(" "+e._s(e.currentEditorLabel)+" "),t("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"dropdown_module"}})]),t("div",{attrs:{slot:"dropdown__content"},slot:"dropdown__content"},e._l(e.editorNames,(function(i){return t("button",{key:i.value,staticClass:"editorDropdown",attrs:{type:"button"},on:{click:function(t){return e.updateEditorName(i.value)}}},[e._v(" "+e._s(i.label)+" ")])})),0)],1)]},proxy:!0}:null],null,!0)},[t("a17-blocks-list",{attrs:{"editor-name":e.editorName},scopedSlots:e._u([{key:"default",fn:function(i){let{availableBlocks:s,hasBlockActive:n,savedBlocks:o,editorNames:a,moveBlock:r}=i;return[t("div",{staticClass:"editor"},[e.revisions.length?t("a17-button",{staticClass:"editor__leave",attrs:{variant:"editor",size:"small"},on:{click:e.openPreview}},[t("span",{directives:[{name:"svg",rawName:"v-svg"}],staticClass:"hide--xsmall",attrs:{symbol:"preview"}}),e._v(e._s(e.$trans("fields.block-editor.preview","Preview"))+" ")]):e._e(),t("div",{staticClass:"editor__frame"},[t("div",{staticClass:"editor__inner"},[t("div",{ref:"sidebar",staticClass:"editor__sidebar"},[t("a17-editorsidebar",{attrs:{"editor-name":e.editorName,hasBlockActive:n,editorNames:a,blocks:s},on:{"editorName:update":e.updateEditorName}},[e._v(" "+e._s(e.$trans("fields.block-editor.add-content","Add content"))+" ")])],1),t("div",{staticClass:"editor__resizer",on:{mousedown:e.resize}},[t("span")]),t("div",{staticClass:"editor__preview"},[e.editorOpen?t("a17-editorpreview",{ref:"previews",attrs:{"editor-name":e.editorName,blocks:o,hasBlockActive:n,sandbox:e.previewSandbox,bgColor:e.bgColor},on:{"blocks:move":r}}):e._e()],1)])])],1)]}}])})],1)},pi=[],hi=i(3405),mi=function(){var e=this,t=e._self._c;return t("a17-blockeditor-model",{attrs:{"editor-name":e.editorName},scopedSlots:e._u([{key:"default",fn:function(i){let{add:s,edit:n,unEdit:o}=i;return[t("div",{staticClass:"editorPreview",class:e.previewClass,style:e.previewStyle,on:{mousedown:function(t){return e._unselectBlock(o)}}},[e.blocks.length?e._e():t("div",{staticClass:"editorPreview__empty"},[t("b",[e._v(e._s(e.$trans("previewer.drag-and-drop","Drag and drop content from the left navigation")))])]),t("draggable",{ref:"previewContent",staticClass:"editorPreview__content",attrs:{value:e.blocks,group:"editorBlocks",handle:e.handle},on:{add:function(t){return e.onAdd(s,n,t)},update:e.onUpdate}},[e._l(e.blocks,(function(i){return[t("a17-blockeditor-model",{key:i.id,attrs:{block:i,"editor-name":e.editorName},scopedSlots:e._u([{key:"default",fn:function(s){let{block:n,isActive:o,blockIndex:a,move:r,remove:l,edit:c,unEdit:d,cloneBlock:u}=s;return[t("a17-editor-block-preview",{key:i.id,ref:n.id,refInFor:!0,attrs:{block:n,blockIndex:a,blocksLength:e.blocks.length,isBlockActive:o},on:{"block:select":function(t){return e._selectBlock(c,a)},"block:unselect":function(t){return e._unselectBlock(d,a)},"block:move":r,"block:clone":function(t){return e._cloneBlock(u,a)},"block:delete":function(t){return e._deleteBlock(l)},"scroll-to":e.scrollToActive}})]}}],null,!0)})]}))],2),e.loading?t("a17-spinner",{attrs:{visible:!0}},[e._v(e._s(e.$trans("fields.block-editor.loading","Loading"))+"… ")]):e._e()],1)]}}])})},fi=[],vi=i(4140),bi=i(4074),_i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"editorPreview__item",class:e.previewBlockItemClasses,on:{mousedown:function(e){e.stopPropagation()}}},[t("div",{staticClass:"editorPreview__frame"},[t("a17-editor-iframe",{ref:"blockIframe",attrs:{block:e.block},on:{loaded:e.iframeLoaded}})],1),t("div",{staticClass:"editorPreview__protector editorPreview__dragger",on:{click:function(t){return t.preventDefault(),e.handleBlockPreviewClick.apply(null,arguments)}}}),t("div",{staticClass:"editorPreview__header"},[t("a17-buttonbar",{attrs:{variant:"visible"}},[t("button",{attrs:{type:"button"},on:{click:e.cloneBlock}},[t("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"clone"}})]),e.blocksLength>1?t("a17-dropdown",{ref:"blockDropdown",staticClass:"f--small",attrs:{position:"bottom-left",maxHeight:270},on:{open:e.handleDropDownOpen,close:e.handleDropDownClose}},[t("button",{attrs:{type:"button"},on:{click:function(t){return e.toggleBlockDropdown(e.blockIndex)}}},[t("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"drag"}})]),t("div",{attrs:{slot:"dropdown__content"},slot:"dropdown__content"},e._l(e.blocksLength,(function(i){return t("button",{key:i,attrs:{type:"button"},on:{click:function(t){return e.moveBlock(i-1)}}},[e._v(" "+e._s(i)+" ")])})),0)]):e._e(),t("button",{attrs:{type:"button"},on:{click:e.deleteBlock}},[t("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:"trash"}})])],1)],1)])},gi=[],wi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"editorIframe"},[""===e.preview?t("div",{staticClass:"editorIframe__empty"},[e._v(" "+e._s(e.title)+" ")]):[e.sandbox?t("iframe",{ref:"frame",attrs:{srcdoc:e.preview,sandbox:e.sandboxOptions,scrolling:"no"},on:{load:e.loadedPreview}}):t("iframe",{ref:"frame",attrs:{srcdoc:e.preview,scrolling:"no"},on:{load:e.loadedPreview}})]],2)},ki=[],yi={name:"A17editorIframe",props:{block:{type:Object,default:function(){return{}}}},computed:{preview(){return this.previewsById(this.block.id)||""},title(){return this.block.title||""},sandboxOptions(){return"boolean"===typeof this.sandbox?"allow-same-origin allow-top-navigation allow-scripts":this.sandbox.join(" ")},...(0,n.L8)(["previewsById"])},inject:["sandbox"],methods:{loadedPreview(){this.$refs.frame&&this.$refs.frame.srcdoc&&(this.$emit("loaded",this.$refs.frame),this.resize())},resize(){if(!this.$refs.frame)return;const e=this.$refs.frame.contentWindow.document.body;e.style.overflow="hidden";const t=window.getComputedStyle(e),i=t.getPropertyValue("margin-top"),s=t.getPropertyValue("margin-bottom"),n=e.scrollHeight+parseInt(i)+parseInt(s);window.requestAnimationFrame((()=>{this.$refs.frame.height=n+"px"}))}},mounted(){window.addEventListener("resize",this.resize)},beforeDestroy(){window.removeEventListener("resize",this.resize)}},Ai=yi,Ei=(0,w.A)(Ai,wi,ki,!1,null,"f2eb11aa",null),Ci=Ei.exports,Si=i(1059),Li={name:"A17EditorPreviewBlockItem",props:{isBlockActive:{type:Boolean,default:!1}},mixins:[Si.Pr],components:{"a17-editor-iframe":Ci},data(){return{dropdownOpen:!1}},computed:{previewBlockItemClasses(){return{"editorPreview__item--active":this.isBlockActive,"editorPreview__item--dropdown-open":this.dropdownOpen}}},methods:{handleBlockPreviewClick(){this.isBlockActive?this.unselectBlock():this.selectBlock()},handleDropDownOpen(){this.dropdownOpen=!0},handleDropDownClose(){this.dropdownOpen=!1},iframeLoaded(){this.isBlockActive&&this.$nextTick((()=>{this.$emit("scroll-to",this.$el.offsetTop)}))}},beforeDestroy(){this.unselectBlock()}},Pi=Li,Ii=(0,w.A)(Pi,_i,gi,!1,null,"022e4340",null),xi=Ii.exports,Oi=i(3318),Ti={name:"A17editorPreview",props:{bgColor:{type:String,default:"#FFFFFF"},hasBlockActive:{props:{type:Boolean,default:!1}}},mixins:[Si.PX,Si.Oe],components:{draggable:pt(),"a17-editor-block-preview":xi,"a17-blockeditor-model":bi["default"],"a17-spinner":Oi.A},data(){return{loading:!1,blockSelectIndex:-1,handle:".editorPreview__dragger"}},computed:{previewClass(){const e=(0,vi.A)(this.bgColor);return{"editorPreview--dark":e.getBrightness()<180,"editorPreview--loading":this.loading}},previewStyle(){return{"background-color":this.bgColor}}},methods:{onAdd(e,t,i){const{item:s}=i,n={};n.title=s.getAttribute("data-title"),n.component=s.getAttribute("data-component"),n.icon=s.getAttribute("data-icon");const o=Math.max(0,i.newIndex);this.addAndEditBlock(e,t,{block:n,index:o}),this._selectBlock(null,o)},onUpdate(e){let{oldIndex:t,newIndex:i}=e;this.$emit("blocks:move",{oldIndex:t,newIndex:i})},_selectBlock(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;e&&this.selectBlock(e,t),this.blockSelectIndex!==t&&(this.unSubscribe(),this.blockSelectIndex=t,this._unSubscribeInternal=this.$store.subscribe((e=>{a.$y.REFRESH_BLOCK_PREVIEW.includes(e.type)&&(a.$y.REFRESH_BLOCK_PREVIEW_ALL.includes(e.type)?this.getAllPreviews():this.getPreview(t))})))},_unselectBlock(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.blockSelectIndex;this.unSubscribe(),this.getPreview(t),this.unselectBlock(e,t),this.blockSelectIndex=-1},_deleteBlock(e){this.unSubscribe(),this.deleteBlock(e)},_cloneBlock(e,t){this.cloneBlock(e),this.getPreview(t+1)},unSubscribe(){this._unSubscribeInternal&&(this._unSubscribeInternal(),this._unSubscribeInternal=null)},getAllPreviews(){this.loading=!0,this.$store.dispatch(r.Ay.GET_ALL_PREVIEWS,{editorName:this.editorName}).then((()=>{this.$nextTick((()=>{this.loading=!1}))}))},getPreview(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this.loading=!0,this.$store.dispatch(r.Ay.GET_PREVIEW,{editorName:this.editorName,index:e}).then((()=>{this.$nextTick((()=>{this.loading=!1}))}))},scrollToActive(e){this.$refs.previewContent.$el.scrollTop=Math.max(0,e-20)},resizeAllIframes(){this.$refs.blockPreview&&this.$refs.blockPreview.forEach((e=>{e.$refs.blockIframe.resize()}))},_resize:v()((function(){this.resizeAllIframes()}),200),init(){window.addEventListener("resize",this._resize)},dispose(){window.removeEventListener("resize",this._resize)}},mounted(){this.init(),this.$nextTick((()=>{this.getAllPreviews()}))},beforeDestroy(){this.dispose()},watch:{editorName(){this.unSubscribe(),this.getAllPreviews()},hasBlockActive(e){e||(this.unSubscribe(),this.blockSelectIndex=-1)}}},Di=Ti,$i=(0,w.A)(Di,mi,fi,!1,null,"0b739bf6",null),Bi=$i.exports,Ri=function(){var e=this,t=e._self._c;return t("div",{staticClass:"editorSidebar"},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.hasBlockActive,expression:"hasBlockActive"}]},[t("a17-blocks-list",{attrs:{"editor-name":e.editorName},scopedSlots:e._u([{key:"default",fn:function(i){let{allSavedBlocks:s}=i;return[t("div",{staticClass:"editorSidebar__edit-list"},e._l(s,(function(i){return t("a17-blockeditor-model",{key:i.id,attrs:{block:i,"editor-name":e.editorName},scopedSlots:e._u([{key:"default",fn:function(i){let{block:n,isActive:o,blockIndex:a,move:r,remove:l,unEdit:c}=i;return[t("div",{staticClass:"editorSidebar__edit-block"},[t("a17-sidebar-block-item",{directives:[{name:"show",rawName:"v-show",value:o,expression:"isActive"}],attrs:{block:n,blockIndex:a,blocksLength:s.length},on:{"block:move":r,"block:delete":function(t){return e.deleteBlock(l)}}}),t("div",{staticClass:"editorSidebar__actions"},[t("a17-button",{attrs:{variant:"action"},on:{click:function(t){return e.saveBlock(c,a)}}},[e._v(" "+e._s(e.$trans("editor.done"))+" ")]),t("a17-button",{attrs:{variant:"secondary"},on:{click:function(t){return e.cancelBlock(c,a)}}},[e._v(" "+e._s(e.$trans("editor.cancel"))+" ")])],1)],1)]}}],null,!0)})})),1)]}}])})],1),e.hasBlockActive?e._e():[t("div",{staticClass:"editorSidebar__list"},[t("a17-sidebar-block-list",{attrs:{blocks:e.blocks}})],1),t("div",{staticClass:"editorSidebar__actions"},[e.isSubmitDisabled(e.submitOptions[0])?t("a17-button",{attrs:{variant:"validate",disabled:!0}},[e._v(e._s(e.submitOptions[0].text))]):t("a17-button",{attrs:{name:e.submitOptions[0].name,variant:"validate"},on:{click:function(t){return e.saveForm(e.submitOptions[0].name)}}},[e._v(e._s(e.submitOptions[0].text))])],1)]],2)},Ni=[],Mi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"editorSidebar__item"},[t("div",{staticClass:"editorSidebar__title"},[t("div",{staticClass:"editorSidebar__blockTitle"},[t("a17-dropdown",{ref:"blockDropdown",staticClass:"f--small",attrs:{position:"bottom-left",maxHeight:270}},[t("span",{staticClass:"editorSidebar__counter f--tiny",on:{click:e.toggleBlockDropdown}},[e._v(e._s(e.blockIndex+1))]),t("div",{attrs:{slot:"dropdown__content"},slot:"dropdown__content"},e._l(e.blocksLength,(function(i){return t("button",{key:i,attrs:{type:"button"},on:{click:function(t){return e.moveBlock(i-1)}}},[e._v(" "+e._s(i)+" ")])})),0)]),e._v(" "+e._s(e.block.title)+" ")],1),t("span",[t("a",{staticClass:"f--small f--note f--underlined",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.deleteBlock.apply(null,arguments)}}},[e._v(e._s(e.$trans("editor.delete")))])])]),t("div",{staticClass:"editorSidebar__body"},[t("a17-inputframe",{attrs:{label:"",name:`block.${e.block.id}`}}),[t(`${e.block.type}`,e._b({key:"`editor_${block.type}_${block.id}`",tag:"component",attrs:{name:`blocks[${e.block.id}]`}},"component",e.setBlockAttributes(e.block.attributes),!1))]],2)])},Vi=[],Fi={name:"A17EditorSidebarBlockItem",mixins:[Si.Pr],methods:{setBlockAttributes(e){return{keepAlive:!0,...e}}}},Ui=Fi,zi=(0,w.A)(Ui,Mi,Vi,!1,null,"a1e1170c",null),Wi=zi.exports,ji=function(){var e=this,t=e._self._c;return t("div",{staticClass:"editorSidebar__listItems"},[t("draggable",{staticClass:"editorSidebar__blocks",class:e.editorSidebarClasses,attrs:{options:{group:{name:"editorBlocks",pull:"clone",put:!1},handle:".editorSidebar__button"}},model:{value:e.blocks,callback:function(t){e.blocks=t},expression:"blocks"}},e._l(e.blocks,(function(i){return t("div",{key:i.component,staticClass:"editorSidebar__button",attrs:{"data-title":i.title,"data-icon":i.icon,"data-component":i.component}},[t("span",{directives:[{name:"svg",rawName:"v-svg"}],attrs:{symbol:e.iconSymbol(i.icon)}}),t("span",{staticClass:"editorSidebar__buttonLabel"},[e._v(e._s(i.title))])])})),0)],1)},Hi=[],Ki={name:"A17EditorSidebarBlockList",props:{blocks:{type:Array,default:()=>[]},inFieldset:{type:Boolean,default:!1}},mixins:[Si.PX],components:{draggable:pt()},computed:{editorSidebarClasses(){return{"editorSidebar__blocks--in-fieldset":this.inFieldset}}},methods:{iconSymbol:function(e){return this.hasLgIconVariation(e)?`${e}-lg`:e},hasLgIconVariation:function(e){return Boolean(document.querySelector(`#icon--${e}-lg`))}}},qi=Ki,Gi=(0,w.A)(qi,ji,Hi,!1,null,"0f803405",null),Yi=Gi.exports,Ji={name:"A17editorSidebar",props:{hasBlockActive:{type:Boolean,default:!1},activeBlock:{type:Object,default:()=>{}},editorName:{type:String,required:!0},editorNames:{type:Array,default:()=>[]}},components:{"a17-sidebar-block-item":Wi,"a17-sidebar-block-list":Yi,"a17-blocks-list":hi["default"],"a17-blockeditor-model":bi["default"]},mixins:[Si.Oe],computed:{submitOptions(){return this.$store.getters.getSubmitOptions}},methods:{isSubmitDisabled:function(e){return!!e.hasOwnProperty("disabled")&&!0===e.disabled},saveForm(e){this.$store.commit(a.N.UPDATE_SAVE_TYPE,e),this.$root.submitForm&&this.$root.submitForm()}}},Xi=Ji,Zi=(0,w.A)(Xi,Ri,Ni,!1,null,"7c217157",null),Qi=Zi.exports,es={name:"A17Editor",components:{"a17-editorsidebar":Qi,"a17-editorpreview":Bi,"a17-blocks-list":hi["default"]},props:{bgColor:{type:String,default:"#FFFFFF"},previewSandbox:{type:[Boolean,Array],default:!0}},data(){return{editorName:null,editorOpen:!1,htmlEditorClass:Ht.A.editor}},computed:{currentEditorLabel(){const e=this.editorNames&&this.editorNames.find((e=>e.value===this.editorName));return e&&e.label},...(0,n.aH)({revisions:e=>e.revision.all,editorNamesBase:e=>e.blocks.editorNames}),...(0,n.L8)(["blocks"]),editorNames(){return this.editorNamesBase.filter((e=>!1===e.nested))}},provide(){return{sandbox:this.previewSandbox}},methods:{initEditorName(){if(!this.editorName){const e=this.editorNames[0]&&this.editorNames[0].value;this.updateEditorName(e)}},updateEditorName(e){this.editorName!==e&&(this.editorName=e)},open(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t&&this.updateEditorName(t),this.editorOpen=!0,this.$refs.overlay.open()},close(){this.editorOpen=!1},resize(){window.addEventListener("mousemove",this.resizeSidebar,!1),window.addEventListener("mouseup",this.stopResizeSidebar,!1)},resizeSidebar(e){const t=this.$refs.sidebar,i=window.innerWidth;t&&(t.style.width=(e.clientX-t.offsetLeft)/i*100+"%")},stopResizeSidebar(){window.removeEventListener("mousemove",this.resizeSidebar,!1),window.removeEventListener("mouseup",this.stopResizeSidebar,!1),this.$refs.previews.resizeAllIframes()},openPreview(){this.$root.$refs.preview&&this.$root.$refs.preview.open()}},created(){this.initEditorName()}},ts=es,is=(0,w.A)(ts,ui,pi,!1,null,"05dfc68c",null),ss=is.exports,ns=i(6567),os=i(9163),as=function(){var e=this,t=e._self._c;return t("a17-modal",{ref:"modal",staticClass:"modal--form",attrs:{title:e.modalTitle,forceClose:!0}},[t("form",{attrs:{action:e.formCreate},on:{submit:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}}},[e._t("default"),t("a17-modal-validation",{attrs:{"is-disable":!0}})],2)])},rs=[],ls=i(8224),cs={name:"A17ModalAdd",mixins:[ls.A],props:{name:{type:String,default:""},modalTitle:{type:String,default:"Add new"},formCreate:{type:String,default:"#"}},components:{"a17-modal-validation":L.A},methods:{open:function(){this.$refs.modal&&this.$refs.modal.open()},submit:function(){if(this.isSubmitPrevented)return void(this.shouldRetrySubmitWhenAllowed=!0);if(this._isSubmitting)return;this._isSubmitting=!0;const e=this;this.$store.commit(a.PI.UPDATE_FORM_LOADING,!0);const t=document.activeElement.name;this.$nextTick((function(){this.$store.dispatch(r.Ay.CREATE_FORM_IN_MODAL,{name:this.name,endpoint:this.formCreate,method:"post"}).then((()=>{e.$refs.modal&&e.$refs.modal.close(),e.$nextTick((function(){e.$store.commit(a.yp.SET_NOTIF,{message:"Your content has been added",variant:"success"}),"create-another"===t&&e.$refs.modal&&e.$refs.modal.open()}))}),(t=>{e.$store.commit(a.yp.SET_NOTIF,{message:"Your content can not be added, please retry",variant:"error"})}))}))}}},ds=cs,us=(0,w.A)(ds,as,rs,!1,null,null,null),ps=us.exports,hs=i(2468);const ms={withPublicationToggle:window["TWILL"].STORE.publication.withPublicationToggle||!1,published:window["TWILL"].STORE.publication.published||!1,publishSubmit:window["TWILL"].STORE.publication.published||!window["TWILL"].STORE.publication.withPublicationToggle?"update":"live",publishedLabel:window["TWILL"].STORE.publication.publishedLabel||"Live",draftLabel:window["TWILL"].STORE.publication.draftLabel||"Draft",expiredLabel:window["TWILL"].STORE.publication.expiredLabel||"Expired",scheduledLabel:window["TWILL"].STORE.publication.scheduledLabel||"Scheduled",withPublicationTimeframe:window["TWILL"].STORE.publication.withPublicationTimeframe||!1,startDate:window["TWILL"].STORE.publication.startDate||null,endDate:window["TWILL"].STORE.publication.endDate||null,visibility:window["TWILL"].STORE.publication.visibility||!1,reviewProcess:window["TWILL"].STORE.publication.reviewProcess||[],userInfo:window["TWILL"].STORE.publication.userInfo||null,createWithoutModal:window["TWILL"].STORE.publication.createWithoutModal||!1,hasUnsavedChanges:!1,saveType:void 0,visibilityOptions:[{value:"public",label:"Public"},{value:"private",label:"Private"}],submitDisableMessage:window["TWILL"].STORE.publication.submitDisableMessage||"",submitOptions:window["TWILL"].STORE.publication.submitOptions||{draft:[{name:"save",text:window.$trans("publisher.save","Save as draft"),disabled:!1},{name:"save-close",text:window.$trans("publisher.save-close","Save as draft and close"),disabled:!1},{name:"save-new",text:window.$trans("publisher.save-new","Save as draft and create new"),disabled:!1},{name:"cancel",text:window.$trans("publisher.cancel","Cancel"),disabled:!1}],live:[{name:"publish",text:window.$trans("publisher.publish","Publish"),disabled:!1},{name:"publish-close",text:window.$trans("publisher.publish-close","Publish and close"),disabled:!1},{name:"publish-new",text:window.$trans("publisher.publish-new","Publish and create new"),disabled:!1},{name:"cancel",text:window.$trans("publisher.cancel","Cancel"),disabled:!1}],update:[{name:"update",text:window.$trans("publisher.update","Update"),disabled:!1},{name:"update-close",text:window.$trans("publisher.update-close","Update and close"),disabled:!1},{name:"update-new",text:window.$trans("publisher.update-new","Update and create new"),disabled:!1},{name:"cancel",text:window.$trans("publisher.cancel","Cancel"),disabled:!1}]}},fs={reviewProcessComplete:e=>e.reviewProcess.filter((e=>e.checked)),getSubmitOptions:e=>e.published||!e.withPublicationToggle?e.submitOptions[e.publishSubmit]:e.submitOptions.draft,isEnabledSubmitOption:(e,t)=>e=>{let i=!0,s={};const n=t.getSubmitOptions.filter((t=>t.name===e));return n.length&&(s=n[0]),s.hasOwnProperty("disabled")&&(i=!s.disabled),i},getSaveType:(e,t)=>e.saveType||t.getSubmitOptions[0].name},vs={[a.N.UPDATE_PUBLISH_START_DATE](e,t){e.startDate=t},[a.N.UPDATE_PUBLISH_END_DATE](e,t){e.endDate=t},[a.N.UPDATE_PUBLISH_STATE](e,t){e.published=t},[a.N.UPDATE_PUBLISH_SUBMIT](e){e.publishSubmit=e.published||!e.withPublicationToggle?"update":"live"},[a.N.UPDATE_PUBLISH_VISIBILITY](e,t){e.visibility=t},[a.N.UPDATE_REVIEW_PROCESS](e,t){let i="",s=-1;t.length&&(i=t[t.length-1],e.reviewProcess.forEach((function(e,t){e.value===i&&(s=t)}))),e.reviewProcess.forEach((function(e,t){e.checked=t<=s,e.disabled=!(t===s||t===s+1)}))},[a.N.UPDATE_SAVE_TYPE](e,t){e.saveType=t},[a.N.UPDATE_HAS_UNSAVED_CHANGES](e,t){e.hasUnsavedChanges=t}};var bs={state:ms,getters:fs,mutations:vs},_s=i(2971),gs=i(2505),ws=i.n(gs),ks=i(7378),ys={getBlockPreview(e,t,i,s){ws().post(e,t).then((function(e){i&&"function"===typeof i&&i(e.data)}),(function(e){const t={message:"Block preview request error.",value:e};(0,ks.i)("CONTENT",t),s&&"function"===typeof s&&s(e)}))}};const As={loading:!1,editor:window["TWILL"].STORE.form.editor||!1,editorNames:window["TWILL"].STORE.form.editorNames||[],available:window["TWILL"].STORE.form.availableBlocks||{},blocks:window["TWILL"].STORE.form.blocks||{},previews:window["TWILL"].STORE.form.previews||{},active:{}},Es={previewsById:e=>t=>e.previews[t]?e.previews[t]:"",blocks:e=>t=>e.blocks[t]||[],availableBlocks:e=>t=>e.available[t]||[],blockIndex:(e,t)=>(e,i)=>t.blocks(i).findIndex((t=>t.id===e.id))},Cs=()=>Date.now()+Math.floor(1e3*Math.random()),Ss={[a.nA.ADD_BLOCK](e,t){let{block:i,index:n,editorName:o}=t;const a=e.blocks[o]||[],r={...i,id:Cs(),name:o};r.twillUi={},r.twillUi.isNew=!0,n>-1?a.splice(n,0,r):a.push(r),s["default"].set(e.blocks,o,a)},[a.nA.MOVE_BLOCK](e,t){let{editorName:i,newIndex:n,oldIndex:o}=t;const a=e.blocks[i]||[];if(n>=a.length){let e=n-a.length;while(1+e--)a.push(void 0)}a.splice(n,0,a.splice(o,1)[0]),s["default"].set(e.blocks,i,a)},[a.nA.DELETE_BLOCK](e,t){let{editorName:i,index:n}=t;const o=e.blocks[i][n].id,a=e.blocks[i]||[];o&&s["default"].delete(e.previews,o),a.splice(n,1),s["default"].set(e.blocks,i,a)},[a.nA.DUPLICATE_BLOCK](e,t){let{editorName:i,index:n,block:o,id:a}=t;const r=e.blocks[i]||[];r.splice(n,0,{...o,id:a,name:i}),s["default"].set(e.blocks,i,r)},[a.nA.REORDER_BLOCKS](e,t){let{editorName:i,value:n}=t;s["default"].set(e.blocks,i,n)},[a.nA.ACTIVATE_BLOCK](e,t){let{editorName:i,index:s}=t;e.blocks[i]&&e.blocks[i][s]?e.active={...e.blocks[i][s]}:e.active={}},[a.nA.ADD_BLOCK_PREVIEW](e,t){s["default"].set(e.previews,t.id,t.html)},[a.nA.UPDATE_PREVIEW_LOADING](e,t){e.loading=!e.loading}},Ls=(e,t,i,s)=>{if(e&&e.hasOwnProperty("id")){const n=(0,_s.KG)(e,i);i.language.all.length>1&&(n.activeLanguage=i.language.active.value),(0,_s.VX)(n)?(t(a.nA.ADD_BLOCK_PREVIEW,{id:e.id,html:""}),s&&"function"===typeof s&&s()):ys.getBlockPreview(i.form.blockPreviewUrl,n,(i=>{t(a.nA.ADD_BLOCK_PREVIEW,{id:e.id,html:i}),s&&"function"===typeof s&&s()}),(e=>{}))}},Ps={[r.Ay.GET_PREVIEW](e,t){let{commit:i,state:s,rootState:n}=e,{editorName:o,index:a=-1}=t,r=s.blocks[o]&&a>=0?{...s.blocks[o][a]}:{};s.active&&s.active.hasOwnProperty("id")&&-1===a&&(r={...s.active}),Ls(r,i,n)},[r.Ay.GET_ALL_PREVIEWS](e,t){let{commit:i,state:s,rootState:n}=e,{editorName:o}=t;if(s.blocks[o]&&s.blocks[o].length>0&&!s.loading){i(a.nA.UPDATE_PREVIEW_LOADING,!0);let e=0;const t=s.blocks[o].length;Object.values(s.blocks[o]).forEach((s=>{Ls(s,i,n,(()=>{e++,e===t&&i(a.nA.UPDATE_PREVIEW_LOADING,!0)}))}))}},async[r.Ay.DUPLICATE_BLOCK](e,t){let{commit:i,state:s,rootState:n}=e,{editorName:o,futureIndex:r,block:l,id:c}=t;i(a.nA.DUPLICATE_BLOCK,{editorName:o,index:r,block:l,id:c})},async[r.Ay.MOVE_BLOCK_TO_EDITOR](e,t){let{commit:i,dispatch:s}=e,{editorName:n,index:o,block:l,futureIndex:c,id:d}=t;await s(r.Ay.DUPLICATE_BLOCK,{editorName:n,futureIndex:c,block:l,id:d}),i(a.nA.DELETE_BLOCK,{editorName:l.name,index:o})}};var Is={state:As,getters:Es,mutations:Ss,actions:Ps},xs=i(8037),Os={getRevisionContent(e,t,i,s){ws().put(e,t).then((function(e){i&&"function"===typeof i&&i(e.data)}),(function(e){const t={message:"Preview request error.",value:e};(0,ks.i)("REVISION",t),s&&"function"===typeof s&&s(e)}))}};const Ts={loading:!1,active:{},activeContent:"",currentContent:"",all:window["TWILL"].STORE.revisions||[]},Ds={},$s={[a.sP.LOADING_REV](e){e.loading=!0},[a.sP.UPDATE_REV](e,t){function i(e){return e.id===t}const s=e.all.findIndex(i);e.active=-1!==s?e.all[s]:{}},[a.sP.UPDATE_REV_CONTENT](e,t){e.loading=!1,e.activeContent=t},[a.sP.UPDATE_REV_CURRENT_CONTENT](e,t){e.loading=!1,e.currentContent=t},[a.sP.UPDATE_REV_ALL](e,t){e.all=t}},Bs={[r.Ay.GET_CURRENT](e){let{commit:t,rootState:i}=e;return new Promise(((e,s)=>{t(a.sP.LOADING_REV);const n=(0,_s.tg)(i);i.language.all.length>1&&(n.activeLanguage=i.language.active.value),Os.getRevisionContent(i.form.previewUrl,n,(i=>{t(a.sP.UPDATE_REV_CURRENT_CONTENT,i),e()}),(e=>{s(e)}))}))},[r.Ay.GET_REVISION](e){let{commit:t,state:i,rootState:s}=e;return new Promise(((e,n)=>{t(a.sP.LOADING_REV);let o=0;o=0===Object.keys(i.active).length?i.all[0].id:i.active.id;const r={revisionId:o};s.language.all.length>1&&(r.activeLanguage=s.language.active.value),Os.getRevisionContent(s.form.previewUrl,r,(i=>{t(a.sP.UPDATE_REV_CONTENT,i),e()}),(e=>{n(e)}))}))}};var Rs={state:Ts,getters:Ds,actions:Bs,mutations:$s},Ns=i(7903);const Ms={repeaters:window["TWILL"].STORE.form.repeaters||{},availableRepeaters:window["TWILL"].STORE.form.availableRepeaters||{}},Vs={repeatersByBlockId:e=>t=>{const i=Object.keys(e.repeaters).filter((e=>e.startsWith(`blocks-${t}`))),s={};return i.forEach((t=>s[t]=e.repeaters[t])),s}};function Fs(){return Date.now()+Math.floor(1e3*Math.random())}const Us={[a.PI.ADD_FORM_BLOCK](e,t){const i=t.name,s=t.type,n={},o=e.availableRepeaters[s],a=!e.repeaters[i];if(o)if(n.id=Fs(),n.type=o.component,n.title=o.title,n.twillUi={},n.twillUi.isNew=!0,a){const t={};t[i]=[],t[i].push(n),e.repeaters=Object.assign({},e.repeaters,t)}else e.repeaters[i].push(n)},[a.PI.ADD_REPEATER_FROM_SELECTION](e,t){const i=t.name,s=t.type,n=e.availableRepeaters[s],o=!e.repeaters[i];if(!n)return;const r={};r[i]=[],t.selection.forEach((t=>{const s={};s.id=Fs(),s.type=n.component,s.title=n.title,s.repeater_target_id=t.id;const l=[];for(const e in t.repeaterFields)t.repeaterFields.hasOwnProperty(e)&&l.push({name:`blocks[${s.id}][${e}]`,value:t.repeaterFields[e]});this.commit(a.PI.ADD_FORM_FIELDS,l),o?r[i].push(s):e.repeaters[i].push(s)})),o&&(e.repeaters=Object.assign({},e.repeaters,r))},[a.PI.DELETE_FORM_BLOCK](e,t){e.repeaters[t.name].splice(t.index,1)},[a.PI.DUPLICATE_FORM_BLOCK](e,t){const i=Object.assign({},e.repeaters[t.name][t.index]);i.id=Fs(),i.twillUi={},i.twillUi.isNew=!0,e.repeaters[t.name].splice(t.index+1,0,i);const s=[...Vs.fieldsByBlockId(t.id)],n=[];s.forEach((e=>{n.push({name:e.name.replace(t.id,i.id),value:e.value})})),this.commit(a.PI.ADD_FORM_FIELDS,n)},[a.PI.REORDER_FORM_BLOCKS](e,t){const i={};i[t.name]=t.blocks,e.repeaters=Object.assign({},e.repeaters,i)},[a.PI.ADD_REPEATERS](e,t){let{repeaters:i}=t;e.repeaters=Object.assign({},e.repeaters,i)}},zs={async[r.Ay.DUPLICATE_REPEATER](e,t){let{state:i,commit:s,getters:n}=e,{editorName:o,block:r,index:l,id:c}=t;const d=Object.assign({},i.repeaters[o][l]);d.id=c,d.twillUi={},d.twillUi.isNew=!0;const u={};u[o]=[...i.repeaters[o]],u[o].splice(l+1,0,d);const p=[...n.fieldsByBlockId(r.id)],h=[];p.forEach((e=>{h.push({name:e.name.replace(r.id,d.id),value:JSON.parse(JSON.stringify(e.value))})})),s(a.PI.ADD_FORM_FIELDS,h),s(a.PI.ADD_REPEATERS,{repeaters:u})},async[r.Ay.DUPLICATE_BLOCK](e,t){let{commit:i,getters:s}=e,{block:n,id:o}=t;const r={...s.repeatersByBlockId(n.id)},l=Object.keys(r),c={};l.forEach((e=>c[e.replace(n.id,o)]=[...r[e]]));const d=[];Object.keys(c).forEach((e=>{c[e].forEach(((t,i)=>{const n=Date.now()+Math.floor(1e3*Math.random()),o=[...s.fieldsByBlockId(t.id)];c[e][i]={...c[e][i],id:n},o.forEach((e=>{d.push({name:e.name.replace(t.id,n),value:JSON.parse(JSON.stringify(e.value))})}))}))})),i(a.PI.ADD_REPEATERS,{repeaters:c}),i(a.PI.ADD_FORM_FIELDS,d)}};var Ws={state:Ms,getters:Vs,mutations:Us,actions:zs};const js={active:window["TWILL"].STORE.parentId||0,all:window["TWILL"].STORE.parents||[]},Hs={},Ks={[a.we.UPDATE_PARENT](e,t){e.active=t||0}};var qs={state:js,getters:Hs,mutations:Ks},Gs=i(850);const Ys={groups:window["TWILL"].STORE.groups||[],groupUserMapping:window["TWILL"].STORE.groupUserMapping||[]};var Js={state:Ys},Xs=i(7230),Zs=i(6321),Qs=i(8055),en=i.n(Qs),tn=i(3031),sn=i.n(tn);s["default"].use(ns.A),s["default"].use(os.A),o.A.registerModule("form",hs.A),o.A.registerModule("publication",bs),o.A.registerModule("blocks",Is),o.A.registerModule("language",xs.A),o.A.registerModule("revision",Rs),o.A.registerModule("browser",Ns.A),o.A.registerModule("repeaters",Ws),o.A.registerModule("parents",qs),o.A.registerModule("attributes",Gs.A),o.A.registerModule("permissions",Js),s["default"].component("a17-fieldset",p.A),s["default"].component("a17-publisher",tt),s["default"].component("a17-title-editor",$),s["default"].component("a17-blocks",lt["default"]),s["default"].component("a17-page-nav",rt),s["default"].component("a17-langswitcher",B.A),s["default"].component("a17-sticky-nav",y),s["default"].component("a17-spinner",Oi.A),s["default"].component("a17-repeater",gt),s["default"].component("a17-browser",zt.A),s["default"].component("a17-connectorfield",Ut),s["default"].component("a17-locationfield",Dt),s["default"].component("a17-overlay",Zt),s["default"].component("a17-previewer",di),s["default"].component("a17-editor",ss),s["default"].component("a17-modal-add",ps),(0,d.A)(),window["TWILL"].vm=window.vm=new s["default"]({store:o.A,el:"#app",mixins:[Xs.A,Zs.A,ls.A],data:function(){return{unSubscribe:function(){return null},isFormUpdated:!1}},computed:{...(0,n.aH)({loading:e=>e.form.loading,editor:e=>e.blocks.editor,isCustom:e=>e.form.isCustom}),...(0,n.L8)(["getSaveType","isEnabledSubmitOption"])},methods:{submitForm:function(){this.isSubmitPrevented?this.shouldRetrySubmitWhenAllowed=!0:this.loading||(this.isFormUpdated=!1,this.$store.commit(a.PI.UPDATE_FORM_LOADING,!0),this.unSubscribe(),this.$nextTick((()=>{const e=this.getSaveType||document.activeElement.name;this.isEnabledSubmitOption(e)?this.$store.dispatch(r.Ay.SAVE_FORM,e).then((()=>{this.mutationsSubscribe()})):(this.$store.commit(a.PI.UPDATE_FORM_LOADING,!1),this.mutationsSubscribe())})))},confirmExit:function(e){if(this.isFormUpdated&&!this.isCustom)return"message";void 0!==window.event?window.event.cancelBubble=!0:e.cancelBubble=!0},mutationsSubscribe:function(){this.unSubscribe=this.$store.subscribe(((e,t)=>{l.f.includes(e.type)&&(this.isFormUpdated=!0,this.unSubscribe())}))},watchForFormUpdates(e,t){const i="form"===e&&("fields"===t||"modalFields"===t),s=this.sortObjectArraysDeep(en()(this.$store.state[e][t]),i);this.$store.watch((i=>i[e][t]),(e=>{const t=this.sortObjectArraysDeep(en()(e),i);this.isFormUpdated=!At()(s,t),this.$store.commit(a.N.UPDATE_HAS_UNSAVED_CHANGES,this.isFormUpdated)}),{deep:!0})},sortArrayByFirstKey(e){return sn()(e,(e=>{if("object"===typeof e){const t=Object.keys(e)[0];return e[t]}return e}))},sortObjectArraysDeep(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Array.isArray(e)&&t?e=this.sortArrayByFirstKey(e):Object.keys(e).forEach((i=>{Array.isArray(e[i])?t&&(e[i]=this.sortArrayByFirstKey(e[i])):"object"===typeof e[i]&&(e[i]=this.sortObjectArraysDeep(e[i]))})),e}},mounted:function(){window.onbeforeunload=this.confirmExit,this.$nextTick((()=>{this.watchForFormUpdates("mediaLibrary","selected"),this.watchForFormUpdates("form","fields"),this.watchForFormUpdates("form","modalFields"),this.watchForFormUpdates("blocks","blocks"),this.watchForFormUpdates("browser","selected"),this.watchForFormUpdates("repeaters","repeaters")}))},beforeDestroy:function(){this.unSubscribe()},created:function(){(0,u.A)()}}),document.addEventListener("DOMContentLoaded",c.A)}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}i.m=e,function(){var e=[];i.O=function(t,s,n,o){if(!s){var a=1/0;for(d=0;d<e.length;d++){s=e[d][0],n=e[d][1],o=e[d][2];for(var r=!0,l=0;l<s.length;l++)(!1&o||a>=o)&&Object.keys(i.O).every((function(e){return i.O[e](s[l])}))?s.splice(l--,1):(r=!1,o<a&&(a=o));if(r){e.splice(d--,1);var c=n();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[s,n,o]}}(),function(){i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,{a:t}),t}}(),function(){i.d=function(e,t){for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.hmd=function(e){return e=Object.create(e),e.children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e}}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){i.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){i.j=319}(),function(){var e={319:0};i.O.j=function(t){return 0===e[t]};var t=function(t,s){var n,o,a=s[0],r=s[1],l=s[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(n in r)i.o(r,n)&&(i.m[n]=r[n]);if(l)var d=l(i)}for(t&&t(s);c<a.length;c++)o=a[c],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return i.O(d)},s=self["webpackChunk_area17_twill"]=self["webpackChunk_area17_twill"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=i.O(void 0,[504,996],(function(){return i(2194)}));s=i.O(s)})();